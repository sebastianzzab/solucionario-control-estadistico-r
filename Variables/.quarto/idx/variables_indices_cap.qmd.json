{"title":"Diagramas de Control para Variables y An√°lisis de Indices de Capacidad de Procesos Aplicados con ${\\color{Blue} \\textbf{\\textsf{R}}}$","markdown":{"yaml":{"title":"Diagramas de Control para Variables y An√°lisis de Indices de Capacidad de Procesos Aplicados con ${\\color{Blue} \\textbf{\\textsf{R}}}$"},"headingText":"Diagramas de control para variables","containsRefs":false,"markdown":"\n\n\nLos diagramas de control para variables son herramientas gr√°ficas del Control Estad√≠stico de Procesos (CEP) que se usan para monitorear y analizar un proceso a lo largo del tiempo. Su objetivo principal es distinguir entre las variaciones comunes (aleatorias e inherentes al proceso) y las variaciones especiales o asignables (causadas por eventos espec√≠ficos e inesperados).\n\nEstos diagramas se aplican a caracter√≠sticas de calidad que se pueden medir en una escala continua, como:\n\n-   Peso de un producto.\n\n-   Longitud o di√°metro de una pieza.\n\n-   Temperatura de un horno.\n\n-   Tiempo de un ciclo de producci√≥n.\n\n## ¬øC√≥mo funcionan? \n\nüìà Un diagrama de control para variables grafica los datos de tu proceso en una secuencia de tiempo. T√≠picamente, consta de tres l√≠neas horizontales:\n\n**L√≠nea Central (LC)**: Representa el promedio hist√≥rico o el valor objetivo de la caracter√≠stica que se est√° midiendo. Es el rendimiento esperado del proceso.\n\n**L√≠mite de Control Superior (LCS)**: Se ubica tres desviaciones est√°ndar por encima de la l√≠nea central.\n\n**L√≠mite de Control Inferior (LCI)**: Se ubica tres desviaciones est√°ndar por debajo de la l√≠nea central.\n\nLa idea es que, si un proceso es estable y solo presenta variaciones comunes, casi todos los puntos graficados se encontrar√°n dentro de estos l√≠mites de control y distribuidos de manera aleatoria alrededor de la l√≠nea central.\n\nUn punto fuera de los l√≠mites de control o un patr√≥n no aleatorio (como una tendencia ascendente, 7 puntos seguidos de un mismo lado de la l√≠nea central, etc.) es una se√±al de que existe una causa especial de variaci√≥n. Esto indica que algo inusual ha ocurrido y que el proceso est√° \"fuera de control\", lo que requiere una investigaci√≥n para identificar y corregir el problema.\n\n## Tipos m√°s comunes \n\nGeneralmente, se usan en pares para monitorear tanto la tendencia central como la dispersi√≥n (variabilidad) del proceso:\n\n**Gr√°fica** $\\bar{X}‚àíR$ **(Medias y Rangos)**: Es la m√°s com√∫n. La gr√°fica $\\bar{X}$ (de medias) monitorea el promedio del proceso, mientras que la gr√°fica $R$ (de rangos) monitorea la variabilidad dentro de las muestras. Se usa t√≠picamente con tama√±os de muestra peque√±os (entre 2 y 10).\n\n**Gr√°fica** $\\bar{X}‚àíS$ **(Medias y Desviaci√≥n Est√°ndar)**: Similar a la anterior, pero la gr√°fica $S$ usa la desviaci√≥n est√°ndar en lugar del rango para medir la variabilidad. Es estad√≠sticamente m√°s robusta y se prefiere cuando los tama√±os de muestra son m√°s grandes (mayores a 10).\n\n**Gr√°fica** $I-MR$ **(Individuales y Rango M√≥vil)**: Se utiliza cuando solo se tiene una medici√≥n por cada punto en el tiempo (tama√±o de muestra = 1), como en procesos lentos o donde la medici√≥n es costosa o destructiva.\n\nEn el siguiente bloque de c√≥digo se cargan todas las librer√≠as o paquetes necesarios para el desarrollo de este capitulo, si no se tiene instalado alguno de ellos se instalaran autom√°ticamente. \n\n```{r}\n#| label: carga-paquetes-necesarios\n#| include: false\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\nlibrary(pacman)\npacman::p_load(ggplot2,ggfortify, DT, reshape2, knitr,  tidyverse, ggQC, pammtools, latex2exp, data.table, reactable, htmlwidgets, htmltools, highcharter, tinytex, qcc, kableExtra)\n```\n\nDel mismo modo, se crea una base de datos bib para los paquetes de R que se est√°n utilizando en este capitulo, la cual se puede usar para crear una bibliograf√≠a al final del capitulo.\n\n```{r}\n#| include: false\n#| label: creacion-bibliografias\n\n# Crear automaticamente una base de datos bib para los paquetes de R \nknitr::write_bib(\n  c(\n    .packages(), \"knitr\", \"tidyverse\", \"qcc\", \"ggQC\", \"plotly\",\n    \"highcharter\", \"kableExtra\", \"data.table\", \"pacman\",\n    \"renv\", \"pammtools\", \"htmlwidgets\", \"htmltools\", \"data.table\",\n    \"RColorBrewer\", \"latex2exp\", \"tinytex\", \"reactable\"\n  ),\n  \"packages.bib\"\n)\n\n```\n\nPor otro lado, aqui se crean funciones propias para darle formato a las salidas imprimidas en pantalla. las cuales se pueden usar en cualquier parte del capitulo.\n\n```{r}\n#| label: funciones-creadas\n#| include: false\n\n# funcion para ajustar fill-opacity usando css\nfillOpacity <- function(., alpha = 0.5) {\n  css <- sprintf(\"<style> .js-fill { fill-opacity: %s}\n!important; } </style>\", alpha)\n  prependContent(., HTML(css))\n}\n\n# funcion para dar formato a numero\nformato <- function(x, digits = 4) {\n  if (!is.numeric(x)) stop(\"¬°La entrada debe ser numerica!\")\n  format(\n    round(x, digits = digits),\n    mode = \"double\",\n    big.mark = \".\",\n    decimal.mark = \",\"\n  )\n}\n\n```\n\n## Diagrama de control para la Media($\\bar{X}$) y el Rango($R$)\nLos diagramas de control para la media ($\\bar{X}$) y el rango ($R$) son herramientas fundamentales en el Control Estad√≠stico de Procesos (CEP). Estos diagramas permiten monitorear la tendencia central y la variabilidad de un proceso a lo largo del tiempo, ayudando a identificar si el proceso est√° bajo control estad√≠stico o si existen causas asignables que afectan su desempe√±o. Los mismos seran ejemplificados a continuaci√≥n.\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dcxr .Example}\n### Aplicaci√≥n del diagrama de control para la Media($\\bar{X}$) y el Rango($R$) {#sec-ejemplo-diagrama-xr}\n\n<br/>Se van a establecer gr√°ficas de control para $\\bar{X}$ y $R$ en determinada dimensi√≥n, en mil√≠metros, de una parte. Se reunieron datos en tama√±os de subgrupo igual a 6, y se citan a continuaci√≥n en la @tbl-datos-peso-promedio-rango-parte. Determine la l√≠nea central y los l√≠mites de control tentativos. Suponga que hay causas asignables, y revise la l√≠nea central y los l√≠mites.Este ejemplo fue tomado de @besterfield1995control.\n\n```{r}\n#| label: tbl-datos-peso-promedio-rango-parte\n#| tbl-cap:  \"Mediciones del peso promedio y el rango en mil√≠metros de una parte\"\n#| tbl-colwidths: [20,50]\n# Creando vectoress para X barra y R\nX_bar <- c(20.35, 20.40, 20.36, 20.65, 20.20, 20.40, 20.43, 20.37, 20.48, 20.42, 20.39, 20.38, 20.40, 20.41, 20.45, 20.34, 20.36, 20.42, 20.50, 20.31, 20.39, 20.39, 20.40, 20.41, 20.40)\nR <- c(0.34, 0.36, 0.32, 0.36, 0.36, 0.35, 0.31, 0.34, 0.30, 0.37, 0.29, 0.30, 0.33, 0.36, 0.34, 0.36, 0.37, 0.73, 0.38, 0.35, 0.38, 0.33, 0.32, 0.34, 0.30)\n\n\n# Creando el dataframe\ndf <- data.frame(X_bar = X_bar, R = R)\n\ndatos <- df |>\n  dplyr::mutate(\n    muestra = 1:nrow(df)\n  ) |>\n  dplyr::rename(\n    media = X_bar, \n    rango = R     \n  ) |>\n  dplyr::relocate(\n    muestra,\n    .before = media\n  ) |>\n  data.table::as.data.table()\n\nformato <- function(x, digits = 4) {\n  formatC(x, format = \"f\", digits = digits, big.mark = \".\", decimal.mark = \",\")\n}\n\n# Configuraciones Reactable \noptions(\n  reactable.language = reactableLang(\n    searchPlaceholder = \"buscar...\",\n    pageNext = \"Siguiente\",\n    pagePrevious = \"Anterior\",\n    noData = \"No entries found\",\n    pageInfo = \"{rowStart} de {rowEnd} de {rows} filas\"\n  )\n)\n\n# Reactable tabla para los nuevos datos\nreactable::reactable(\n  datos,\n  list(\n    muestra = colDef(header = \"Muestra\", align = \"right\"),\n    media = colDef(\n      header = \"\\\\( \\\\bar{x}_i \\\\)\", align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 3, locales = \"es-ES\"\n      )\n    ),\n    rango = colDef(\n      header = \"\\\\( R_i \\\\)\", align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 3, locales = \"es-ES\"\n      )\n    )\n  ),\n  defaultColDef = colDef(align = \"center\"),\n  striped = TRUE,\n  bordered = TRUE,\n  highlight = TRUE\n)\n```\n\nUna vez observados los datos, Se proceder√° ahora a calcular los limites para ambos diagramas de control, para lo cual se usara el paquete `SixSigma` que contiene las constantes necesarias para calcular los limites de control, recordando que es un estudio inicial por lo que no se tienen ni los par√°metros ni estimaciones de los mismos. \n\nPrimeramente, para la construcci√≥n del diagrama $R$, se requiere determinar $D_{3}$ y $D_{4}$, lo cual se puede obtener de la respectiva tabla, teniendo en cuenta que $n=6$, o mediante el siguiente bloque de c√≥digo: \n\n```{r}\n#| label: d3-d4\n\nn <- 6 # Sample size\nD_3 <- ifelse(\n  1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n)) < 0, 0, 1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd3(n))\n)\nD_4 <- 1 + 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n\npaste0(\"D_3 = \", formato(D_3), \"   D_4 = \", formato(D_4))\n```\nDe manera que, el calculo de los l√≠mites de control vendr√≠a dado por la siguiente expresi√≥n: \n\n$$\n\\begin{align*}\nLCI & = D_{3}\\,\\bar{R}  \\\\\nLC & = \\bar{R}\\\\\nLCS & = D_{4}\\,\\bar{R} \n\\end{align*}\n$$ {#eq-lcxr}\n\nA continuaci√≥n se muestran los calculos en siguiente bloque de c√≥digo para el diagrama $R$:\n\n```{r}\n#| label: lci-Rbarra\nn <- 6 # Sample size \n\n# Calculate D3 and D4 using SixSigma package\nD_3 <- ifelse(\n  1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n)) < 0, 0, 1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n)\nD_4 <- 1 + 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n\n# Calculate the average of the ranges from your df\nR_barra <- mean(datos$rango)\n\n# Calculate the control limits\nlci_R <- R_barra * D_3\nlc_R <- R_barra\nlcs_R <- R_barra * D_4\n\n# Print the results\npaste0(\"LCI_R = \", formato(lci_R), \"    LC_R = \", formato(lc_R), \"    LCS_R = \", formato(lcs_R))\n\n```\nManualmente, el calculo es el siguiente:\n\n$$\n\\begin{align*}\nLCI & = D_{3}\\,\\bar{R} = `r D_3`*`r R_barra` = `r formato(lci_R)`  \\\\\nLC & = \\bar{R} = `r R_barra`  \\\\\nLCS & = D_{4}\\,\\bar{R} = `r formato(D_4)`*`r R_barra`  = `r formato(lcs_R)`\n\\end{align*}\n$$ \nLa estimaci√≥n de la varianza viene dada por: \n\n$$\n\\hat{\\sigma}=\\frac{\\bar{R}}{d_{2}}= \\frac{`r R_barra`}{`r formato(SixSigma::ss.cc.getd2(n))`} = `r formato(R_barra/SixSigma::ss.cc.getd2(n))`\n$$\nPara el diagrama $\\bar{x}$, los limites se obtienen mediante la siguiente formula:\n\n$$\n\\begin{align*}\nLCS & = \\bar{\\bar{x}} + A_2 \\bar{R} \\\\\nLC  & = \\bar{\\bar{x}} \\\\\nLCI & = \\bar{\\bar{x}} - A_2 \\bar{R}\n\\end{align*} \n$${#eq-lcx}\n\nIgualmente se calculan ahora los limites para el diagrama $\\bar{X}$, para lo cual se usara el paquete `SixSigma` que contiene las constantes necesarias para calcular los limites de control.\n\n```{r}\n#| label: lci-xbarra\n\nn <- 6\n\n# Calculate A_2 using SixSigma package\nA_2 <- 3 / (sqrt(n) * SixSigma::ss.cc.getd2(n))\n\n# Calculate the overall average of the sample means from your df\nmedia_est <- mean(datos$media) # This corresponds to X_double_bar\n\n# Calculate the control limits\nlci_X <- media_est - A_2 * R_barra\nlc_X <- media_est\nlcs_X <- media_est + A_2 * R_barra\n\n# Print the results\npaste0(\"LCI_X = \", formato(lci_X), \"    LC_X = \", formato(lc_X), \"    LCS_X = \", formato(lcs_X))\n```\nManualmente, los calculos se realizan de la siguiente forma: \n\n$$\n\\begin{align*}\nLCS & = \\bar{\\bar{x}} + A_2 \\bar{R} = `r formato(media_est)`+`r formato(A_2)`*`r R_barra`= `r formato(lcs_X)` \\\\\nLC  & = \\bar{\\bar{x}} = `r formato(lc_X)`\\\\\nLCI & = \\bar{\\bar{x}} - A_2 \\bar{R} = `r formato(media_est)`-`r formato(A_2)`*`r R_barra`= `r formato(lci_X)`\n\\end{align*} \n$$\n\nUna vez determinados los limites de control ya es posible realizar los diagramas de control respectivos con el paquete `highcharter`. Los cuales se pueden ver a continuaci√≥n:\n\n```{r}\n#| label: fig-R-highcharter\n#| fig-cap: \"Diagramas $R$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\n# Diagrama de Control para el Rango (Gr√°fico R)\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_R, high = lcs_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_R, high = lc_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_R), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = rango),\n    marker = list(\n      radius = 3, fillColor = \"blue\", symbol = \"circle\"\n    ),\n    useHTML = TRUE,\n    name = \"<b><i>R<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango (R<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nSe puede observar en la @fig-R-highcharter el rango asociado al subgrupo 18 se encuentra fuera de los limites de control, por lo que suponiendo causas asignables el proceso esta fuera de control estad√≠stico. Por lo que se tiene que recalcular los limites de control y construir nuevamente el diagrama $R$.\n\n```{r}\n#| label: fig-xbarra-highcharter\n#| fig-cap: \"Diagramas $\\\\bar{x}$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nSe puede observar igualmente en la @fig-xbarra-highcharter que aqui existen dos puntos consecutivos (4 y 5) fuera de los limites de control , por lo que suponiendo causas atribuibles el proceso se encuentra fuera de control estadistico. Por lo que se tiene que recalcular los limites de control y contruir nuevamente el diagrama $\\bar{X}$.\n\nLos limites para el diagrama $R$, serian ahora los siguientes:\n\n```{r}\n#| label: lci-Rbarra-def\ndatos <- datos[-c(4,5,18)]\n# Calculate D3 and D4 using SixSigma package\nD_3 <- ifelse(\n  1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n)) < 0, 0, 1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n)\nD_4 <- 1 + 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n\n# Calculate the average of the ranges from your df\nR_barra <- mean(datos$rango)\n\n# Calculate the control limits\nlci_R <- R_barra * D_3\nlc_R <- R_barra\nlcs_R <- R_barra * D_4\n\n# Print the results\npaste0(\"LCI_R = \", formato(lci_R), \"    LC_R = \", formato(lc_R), \"    LCS_R = \", formato(lcs_R))\n\n```\n\nPor otro lado, los limites para el diagrama $\\bar{X}$ son los siguientes:\n\n```{r}\n#| label: lci-xbarra-def\nn <- 6\n\n# Calculate A_2 using SixSigma package\nA_2 <- 3 / (sqrt(n) * SixSigma::ss.cc.getd2(n))\n\n# Calculate the overall average of the sample means from your df\nmedia_est <- mean(datos$media) # This corresponds to X_double_bar\n\n# Calculate the control limits\nlci_X <- media_est - A_2 * R_barra\nlc_X <- media_est\nlcs_X <- media_est + A_2 * R_barra\n\n# Print the results\npaste0(\"LCI_X = \", formato(lci_X), \"    LC_X = \", formato(lc_X), \"    LCS_X = \", formato(lcs_X))\n```\n\n```{r}\n#| label: fig-R-highcharter-def\n#| fig-cap: \"Diagramas $R$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_R, high = lcs_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_R, high = lc_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_R), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = rango),\n    marker = list(\n      radius = 3, fillColor = \"blue\", symbol = \"circle\"\n    ),\n    useHTML = TRUE,\n    name = \"<b><i>R<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango (R<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar ninguno de los puntos se encuentra fuera de los limites de control.\n\n```{r}\n#| label: fig-xbarra-highcharter-def\n#| fig-cap: \"Diagramas $\\\\bar{x}$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nIgualmente, como se puede observar ninguno de los puntos se encuentra fuera de los limites de control. Por lo que, dado que para ambos diagramas de control (@fig-R-highcharter-def y @fig-xbarra-highcharter-def) no se encuentran ahora puntos fuera de control, se puede decir entonces que el proceso es estable o bajo control tanto en media como en varianza.\n\n### Capacidad del Proceso\n\nPara determinar la capacidad del proceso estabilizado, se informa que la especificaci√≥n superior (LSE) para la dimensi√≥n de la parte es de 20.80 mm y la especificaci√≥n inferior (LIE) es de 20.00 mm. Con estos datos y las propiedades del proceso que has determinado (media del proceso revisada y desviaci√≥n est√°ndar estimada a partir del rango promedio revisado), calcula los √≠ndices de capacidad del proceso ($C_p$ y  $C_{pk}$) y eval√∫a qu√© tan bien est√° operando el proceso en relaci√≥n con las especificaciones.\n\nPara empezar, una vez determinado que el proceso se encuentra bajo control estadistico , se procede a calcular los indices de capacidad del proceso, por este motivo se supondr√° que los datos siguen una distribuci√≥n normal. \n\nLos limites de tolerancia natural fueron los establecidos anteriormente, siendo estos $`r formato(lci_X)`$ y $`r formato(lcs_X)`$.\n\n\n```{r}\n#| label: fig-xr-cp\n#| fig-cap: \"Capacidad del proceso\"\nX_bar <- datos$media \nR <- datos$rango     \n\n# Establecer los l√≠mites de especificaci√≥n\nspec.limits <- c(20, 20.80)\nn <- 6 # Tama√±o del subgrupo\n\n# Calcular la media del rango revisada\nR_barra <- mean(R)\n\n# ESTO ES CR√çTICO: Estimar la desviaci√≥n est√°ndar del proceso (sigma) a partir de R_barra\n# Usamos d2(n) para convertir el rango promedio en una estimaci√≥n de sigma\nsd_estimado_proceso <- R_barra / SixSigma::ss.cc.getd2(n)\n\n# Verifica si tus 'R' (datos$rango despu√©s de la eliminaci√≥n) tienen variabilidad.\n#print(paste(\"R_revisado despu√©s de la eliminaci√≥n:\", paste(R, collapse = \", \")))\n#print(paste(\"Media de R_revisado:\", R_barra))\n#print(paste(\"Desviaci√≥n est√°ndar estimada del proceso (sd_estimado_proceso):\", sd_estimado_proceso))\n\n\n# Realizar el an√°lisis de capacidad del proceso\n# Pasamos la desviaci√≥n est√°ndar estimada al objeto qcc\n# NOTA: qcc(data, type = \"xbar\", ...) espera 'data' sean los *datos crudos* para calcular medias y std.dev.\n# O si le pasas las medias de los subgrupos (como est√°s haciendo con X_bar),\n# DEBES proporcionar una estimaci√≥n de la desviaci√≥n est√°ndar del proceso ('std.dev')\n# o el rango promedio ('R.bar') si quieres que la estime de ah√≠.\n\nxbar_chart_obj <- qcc(X_bar, type = \"xbar\", sizes = n, plot = FALSE,\n                      std.dev = sd_estimado_proceso)\ncapability <- process.capability(xbar_chart_obj, spec.limits = spec.limits , print = FALSE)\n\n# Mostrar los √≠ndices de capacidad del proceso\n#print(capability)\n#summary(capability)\n#plot(capability) # Para ver la gr√°fica de capacidad corregida\n\n# Calcular la porci√≥n ca√≠da (esto deber√≠a ser consistente con 'capability$exp' ahora)\n# mean_data es la media del proceso\nmean_data <- mean(X_bar) # Usar la media de las X_bar revisadas\n\nlower_limit <- spec.limits[1]\nupper_limit <- spec.limits[2]\n\n# Proporci√≥n de unidades por debajo del l√≠mite inferior\nportion_below <- pnorm(lower_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Proporci√≥n de unidades por encima del l√≠mite superior\nportion_above <- 1 - pnorm(upper_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Porci√≥n ca√≠da total\nportion_fallen <- portion_below + portion_above\n\nportion_fallen <- sum(capability$exp)\n\n# Mostrar la porci√≥n ca√≠da\ncat(\"Porci√≥n ca√≠da:\", formato(portion_fallen), \"\\n\")\n```\nEl an√°lisis de capacidad del proceso para la dimensi√≥n de la parte revela que, aunque hay un margen, el desempe√±o no es completamente √≥ptimo.\n\nEl **√≠ndice de capacidad potencial del proceso ($C_p$) de 0.999** indica una capacidad potencial **marginal**. Esto sugiere que la variabilidad intr√≠nseca del proceso es casi igual a la amplitud de las especificaciones. Seg√∫n Montgomery, valores de $C_p$ entre 0.67 y 1.0 son **no adecuados para el trabajo**, se√±alando que el proceso requiere un an√°lisis profundo y modificaciones para alcanzar una calidad satisfactoria, a pesar de estar muy cerca de 1.0.\n\nEl **√≠ndice de capacidad real del proceso ($C_{pk}$) de 0.992** es la **preocupaci√≥n principal**. Al ser el menor de los $C_{pL}$ y $C_{pU}$ (siendo $C_{pL}$ el que lo determina), revela que el proceso **no est√° perfectamente centrado** dentro de los l√≠mites de especificaci√≥n, mostrando una ligera tendencia hacia el l√≠mite inferior. Este valor por debajo de 1.0 confirma que el proceso **no es capaz** de cumplir consistentemente con los requisitos, ya que existe una probabilidad real de producir piezas fuera de especificaci√≥n.\n\nEl **√≠ndice de capacidad de Taguchi ($C_{pm}$) de 0.999**, siendo muy cercano al $C_p$, sugiere que, aunque hay una variabilidad inherente que \"casi\" cabe en las especificaciones, la **desviaci√≥n respecto al valor objetivo (Target)** es m√≠nima. Esto refuerza la necesidad de mejorar la uniformidad y precisi√≥n, principalmente enfoc√°ndose en reducir la variabilidad para aumentar la holgura del proceso dentro de las especificaciones.\n\nLa **porci√≥n ca√≠da esperada (suma de Exp<LSL 0.15% y Exp>USL 0.13%) es de 0.28%**. Esto significa que aproximadamente el **0.28%** de las partes producidas se espera que est√©n fuera de los l√≠mites de especificaci√≥n. Aunque el porcentaje observado (`Obs<LSL 0%`, `Obs>USL 0%`) fue cero en las 22 muestras, la expectativa de casi un 0.3% de defectos subraya la importancia de implementar medidas correctivas para reducir esta proporci√≥n y mejorar la precisi√≥n general del proceso de manufactura.\n:::\n::::\n\n## Diagrama de control para la Media($\\bar{X}$) y la Desviaci√≥n Est√°ndar($S$)\nPara el caso de la media y la desviaci√≥n est√°ndar, se utilizan los diagramas de control $\\bar{X}$ y $S$, respectivamente. Estos diagramas son √∫tiles para monitorear la estabilidad del proceso en t√©rminos de su media y variabilidad. A continuaci√≥n, se muestra un ejemplo de c√≥mo construir estos diagramas a traves de un ejemplo pr√°ctico.\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dcxs .Example}\n### Aplicaci√≥n del diagrama de control para la Media($\\bar{X}$) y la Desviaci√≥n Est√°ndar($S$) {#sec-ejemplo-diagrama-xs}\n\n<br/>Se van a establecer gr√°ficas de control para la dureza Brinell de acero endurecido para herramientas, en kilogramos por mil√≠metro cuadrado. A continuaci√≥n se muestran los datos para tama√±os de subgrupo igual a 8. Determine la l√≠nea central y los l√≠mites de control tentativos para las gr√°ficas $\\bar{x}$ y $s$. Suponga que los puntos fuera de control tienen causas asignables, y calcule los l√≠mites y l√≠nea central revisados. Este ejemplo fue tomado de @besterfield1995control.\n\n```{r}\n#| label: tbl-datos-dureza_Brinell\n#| tbl-cap:  \"Mediciones para la dureza Brinell de acero endurecido para herramientas, en kilogramos por mil√≠metro cuadrado\"\n# Crear el dataframe en R\nnumero_de_subgrupo <- 1:25\nX_bar <- c(540, 534, 545, 561, 576, 523, 571, 547, 584, 552, 541, 545, 546, 551, 522, 579, 549, 508, 569, 574, 563, 561, 548, 556, 553)\nS <- c(26, 23, 24, 27, 25, 50, 29, 29, 23, 24, 28, 25, 26, 24, 29, 26, 28, 23, 22, 28, 33, 23, 25, 27, 23)\n\ndf_dureza <- data.frame(NUMERO_DE_SUBGRUPO = numero_de_subgrupo, X_bar = X_bar, S = S)\n\n# Prepare the data for reactable, adapting from 'pistones' structure\ndureza <- df_dureza |>\n  dplyr::mutate(\n    # 'muestra' corresponds to 'numero_de_subgrupo'\n    muestra = numero_de_subgrupo\n  ) |>\n  dplyr::rename(\n    media = X_bar,        \n    desviacion = S        \n  ) |>\n  dplyr::select(\n    muestra,\n    media,\n    desviacion\n  ) |>\n  data.table::as.data.table()\n\n# Set reactable language options\noptions(\n  reactable.language = reactableLang(\n    searchPlaceholder = \"Buscar...\",\n    pageNext = \"Siguiente\",\n    pagePrevious = \"Anterior\",\n    noData = \"No se encontraron entradas\",\n    pageInfo = \"{rowStart} de {rowEnd} de {rows} filas\"\n  )\n)\n\n# Generate the reactable table\nreactable::reactable(\n  dureza,\n  columns = list(\n    muestra = colDef(header = \"Muestra\", align = \"right\"),\n    media = colDef(\n      header = \"\\\\( \\\\bar{x}_{i} \\\\)\", align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 3, locales = \"es-ES\" # Adjusted digits for your data\n      )\n    ),\n    desviacion = colDef(\n      header = \"\\\\( S_{i} \\\\)\", align = \"right\", # Changed 'r' to correct S_i notation\n      format = colFormat(\n        separators = TRUE, digits = 2, locales = \"es-ES\" # Adjusted digits for your data\n      )\n    )\n  ),\n  striped = TRUE,\n  bordered = TRUE,\n  highlight = TRUE,\n  filterable = TRUE,\n  # You can add a defaultColDef if you want to apply common styles to all columns\n  defaultColDef = colDef(align = \"center\")\n)\n```\nUna vez observados los datos, Se proceder√° ahora a calcular los limites para ambos diagramas de control, para lo cual se usara igualmente el paquete `SixSigma` que contiene las constantes necesarias para calcular los limites de control, recordando que es un estudio inicial por lo que no se tienen ni los par√°metros ni estimaciones de los mismos. \n\nSe empezara calculando los limites del diagrama inicial $S$. Los cuales vienen dados por:\n$$\n\\begin{align*}\nLCS  & =  B_{4}\\,\\bar{S} \\\\\nLC  & =  \\bar{S}\\\\\nLCI  & = B_{3}\\,\\bar{S}\n\\end{align*}\n$$ {#eq-ls}\n\nPor lo que son necesarios los valores de $B_{3}$ y $B_{4}$, pueden ubicarse en sus respectivas tablas, o ser calculados en R mediante el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: B3-B4\n# Define the sample size (n) as specified in the Brinell problem\nn <- 8\n\n# Calculate control chart constants B_3 and B_4 for the S-chart\n# These constants depend on the sample size 'n' and SixSigma::ss.cc.getc4(n)\nB_3 <- ifelse(\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n) < 0, 0,\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\n)\nB_4 <- 1 + 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\npaste(\"B_3=\",B_3,\"   B_4=\",formato(B_4))\n```\n\nLos limites se calculan de la siguiente forma:\n\n```{r}\n#| label: lci-Sbarra\n# Calculate the overall average of the subgroup standard deviations (S-bar)\nS_barra <- mean(dureza$desviacion)\n\n# Calculate the control limits for the S-chart\nlci_S <- B_3 * S_barra # Lower Control Limit for S-chart\nlc_S <- S_barra        # Center Line for S-chart\nlcs_S <- B_4 * S_barra # Upper Control Limit for S-chart\n\n# Print the calculated control limits\npaste0(\"LCI_S = \", formato(lci_S), \"    LC_S = \", formato(lc_S), \"    LCS_S = \", formato(lcs_S))\n```\n\nManualmente, el calculo es el siguiente:\n\n$$\n\\begin{align*}\nLCS  & =  B_{4}\\,\\bar{S} = `r formato(B_4)`*`r formato(S_barra)`= `r formato(lcs_S)` \\\\\nLC  & =  \\bar{S}  = `r formato(lc_S)` \\\\\nLCI  & = B_{3}\\,\\bar{S} = `r formato(B_3)`*`r formato(S_barra)`= `r formato(lci_S)`\n\\end{align*}\n$$ \n\nLos limites para el diagrama de control $\\bar{x}$ se calculan de la siguiente forma:\n$$\n\\begin{align*}\nLCI & = \\bar{\\bar{x}} - A_{3}\\,\\bar{S}  \\\\\nLC & = \\bar{\\bar{x}}  \\\\\nLCS & = \\bar{\\bar{x}} + A_{3}\\,\\bar{S} \n\\end{align*}\n$${#eq-lix}\n\nMediante el siguiente bloque de c√≥digo se obtienen los limites: \n\n```{r}\n#| label: lci-xbarra2\nmedia_est <- mean(dureza$media)\nA_3 <- 3 / (sqrt(n) * SixSigma::ss.cc.getc4(n))\nlci_X <- media_est - A_3 * S_barra\nlc_X <-  media_est\nlcs_X <- media_est + A_3 * S_barra\npaste0(\"LCI = \", formato(lci_X), \"    LC = \", formato(lc_X), \"    LCS = \", formato(lcs_X))\n```\n\nManualmente, se obtienen mediante el siguiente calculo:\n\n$$\n\\begin{align*}\nLCI & = \\bar{\\bar{x}} - A_{3}\\,\\bar{S} = `r formato(media_est)`-`r formato(A_3)`*`r formato(S_barra)`= `r formato(lci_X)`\\\\\nLC & = \\bar{\\bar{x}} = `r formato(lc_X)` \\\\\nLCS & = \\bar{\\bar{x}} + A_{3}\\,\\bar{S} = `r formato(media_est)`+`r formato(A_3)`*`r formato(S_barra)`= `r formato(lcs_X)`\n\\end{align*}\n$$\nUna vez ya calculados los limites. A continuaci√≥n se muestran cada uno de estos diagramas:\n\n```{r}\n#| label: fig-Sinicial-highcharter\n#| fig-cap: \"Diagrama $S$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza,\n    hcaes(x = muestra, low = lc_S, high = lcs_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, \n    hcaes(x = muestra, low = lci_S, high = lc_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2,\n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza,\n    type = \"line\", hcaes(x = muestra, y = lcs_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lc_S), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lci_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = desviacion),\n    marker = list(radius = 3, fillColor = \"blue\"), # A√±adido fillColor para consistencia\n    useHTML = TRUE, name = \"<b><i>S<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Desviaci√≥n est√°ndar (S<sub>i</sub>)</i></b><br>\")\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar en la @fig-Sinicial-highcharter se observa que el punto 6 esta fuera de los limites de control, se concluye que el proceso no esta bajo control estadistico en varianza. Por lo que suponiendo causas asignables se eliminara del diagrama para recalcular los limites y observar nuevamente el comportamiento del proceso.\n\n```{r}\n#| label: fig-xbarra2-inicial-highcharter\n#| fig-cap: \"Diagrama $\\\\bar{x}$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nSe puede observar en la @fig-xbarra2-inicial-highcharter que se tienen dos puntos fuera de los limites de control, siendo los puntos 8 y 18. Ahora bien, el punto 15 se encuentra muy cercano teniendo una diferencia con este de 0,46, lo cual es menor a unidad. Basado en uno de los criterios de General Electric, el cual establece que un punto que se encuentre muy cercano a uno de los limites debera considerarse como una advertencia de que el proceso no esta funcionando como deberia. Por lo que el proceso no se encuentra bajo control estadistico en su media, suponiendo causas asignables se procedera a eliminar los tres puntos de proceso, recalcular los limites y graficar nuevamente el diagrama.\n\nLos nuevos limites para el diagrama $S$, se calculan en el siguiente bloque de c√≥digo: \n```{r}\n#| label: lci-s-def\ndureza <- dureza[-c(6,8,15,18)]\n# Calculate control chart constants B_3 and B_4 for the S-chart\n# These constants depend on the sample size 'n' and SixSigma::ss.cc.getc4(n)\nB_3 <- ifelse(\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n) < 0, 0,\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\n)\nB_4 <- 1 + 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\n\n# Calculate the overall average of the subgroup standard deviations (S-bar)\nS_barra <- mean(dureza$desviacion)\n\n# Calculate the control limits for the S-chart\nlci_S <- B_3 * S_barra # Lower Control Limit for S-chart\nlc_S <- S_barra        # Center Line for S-chart\nlcs_S <- B_4 * S_barra # Upper Control Limit for S-chart\n\n# Define the 'formato' function as it was used in your original snippet\n# (Assuming it formats numbers with commas as decimal separators and two digits)\nformato <- function(x, digits = 4) {\n  formatC(x, format = \"f\", digits = digits, big.mark = \".\", decimal.mark = \",\")\n}\n\n# Print the calculated control limits\npaste0(\"LCI_S = \", formato(lci_S), \"    LC_S = \", formato(lc_S), \"    LCS_S = \", formato(lcs_S))\n\n```\n\nPor otro lado, los nuevos limites para el diagrama $\\bar{X}$, se calculan en el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-xbarra2-def\nmedia_est <- mean(dureza$media)\nA_3 <- 3 / (sqrt(n) * SixSigma::ss.cc.getc4(n))\nlci_X <- media_est - A_3 * S_barra\nlc_X <-  media_est\nlcs_X <- media_est + A_3 * S_barra\npaste0(\"LCI = \", formato(lci_X), \"    LC = \", formato(lc_X), \"    LCS = \", formato(lcs_X))\n```\n\nA continuaci√≥n se muestran los diagramas de control:\n\n```{r}\n#| label: fig-Sinicial-highcharter-def\n#| fig-cap: \"Diagrama $S$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza,\n    hcaes(x = muestra, low = lc_S, high = lcs_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, \n    hcaes(x = muestra, low = lci_S, high = lc_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2,\n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza,\n    type = \"line\", hcaes(x = muestra, y = lcs_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lc_S), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lci_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = desviacion),\n    marker = list(radius = 3, fillColor = \"blue\"), # A√±adido fillColor para consistencia\n    useHTML = TRUE, name = \"<b><i>S<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Desviaci√≥n est√°ndar (S<sub>i</sub>)</i></b><br>\")\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar en la @fig-Sinicial-highcharter-def ninguno de los puntos se encuentra fuera de los limites de control.\n\n```{r}\n#| label: fig-xbarra2-inicial-highcharter-def\n#| fig-cap: \"Diagrama $\\\\bar{x}$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nIgualmente, como se puede observar ninguno de los puntos se encuentra fuera de los limites de control. Por lo que, dado que para ambos diagramas de control (@fig-Sinicial-highcharter-def y @fig-xbarra2-inicial-highcharter-def) no se encuentran ahora puntos fuera de control, se puede decir entonces que la dureza Brinell de acero endurecido para herramientas, en kilogramos por mil√≠metro cuadrado es estable tanto en media como en varianza.\n\n### Capacidad del Proceso\nPara determinar la capacidad del proceso estabilizado, se informa que la especificaci√≥n superior (LSE) para la dureza Brinell es de 600 kg/mm¬≤ y la especificaci√≥n inferior (LIE) es de 500 kg/mm¬≤. Con estos datos y las propiedades del proceso que has determinado (media del proceso revisada y desviaci√≥n est√°ndar estimada a partir del rango promedio revisado), calcula los √≠ndices de capacidad del proceso ($C_p$ y  $C_{pk}$) y eval√∫a qu√© tan bien est√° operando el proceso en relaci√≥n con las especificaciones.\n\nPara empezar, una vez determinado que el proceso se encuentra bajo control estadistico , se procede a calcular los indices de capacidad del proceso, por este motivo se supondr√° que los datos siguen una distribuci√≥n normal. \n\nLos limites de tolerancia natural fueron los establecidos anteriormente, siendo estos $`r formato(lci_X)`$ y $`r formato(lcs_X)`$.\n\n```{r}\n#| label: fig-xs-cp\n#| fig-cap: \"Capacidad del proceso\"\n\nX_bar <- dureza$media\nS <- dureza$desviacion\n# Establecer los l√≠mites de especificaci√≥n\nspec.limits <- c(500, 600)\n\n# Calcular la media del rango revisada\nS_barra <- mean(S)\n\n# ESTO ES CR√çTICO: Estimar la desviaci√≥n est√°ndar del proceso (sigma) a partir de R_barra\n# Usamos d2(n) para convertir el rango promedio en una estimaci√≥n de sigma\nsd_estimado_proceso <- S_barra / SixSigma::ss.cc.getd2(n)\n\nxbar_chart_obj <- qcc(X_bar, type = \"xbar\", sizes = n, plot = FALSE,\n                      std.dev = sd_estimado_proceso)\ncapability <- process.capability(xbar_chart_obj, spec.limits = spec.limits , print = FALSE)\n\n# Calcular la porci√≥n ca√≠da (esto deber√≠a ser consistente con 'capability$exp' ahora)\n# mean_data es la media del proceso\nmean_data <- mean(X_bar) # Usar la media de las X_bar revisadas\n\nlower_limit <- spec.limits[1]\nupper_limit <- spec.limits[2]\n\n# Proporci√≥n de unidades por debajo del l√≠mite inferior\nportion_below <- pnorm(lower_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Proporci√≥n de unidades por encima del l√≠mite superior\nportion_above <- 1 - pnorm(upper_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Porci√≥n ca√≠da total\nportion_fallen <- portion_below + portion_above\n\nportion_fallen <- sum(capability$exp)\n\n# Mostrar la porci√≥n ca√≠da\ncat(\"Porci√≥n ca√≠da:\", formato(portion_fallen), \"\\n\")\n```\n\nEl an√°lisis de capacidad del proceso para la **dureza Brinell de acero endurecido para herramientas** revela que el desempe√±o es **altamente capaz y robusto**. \n\nEl **√≠ndice de capacidad potencial del proceso ($C_p$) de 1.85** indica una **excelente capacidad potencial**. Esto sugiere que la variabilidad intr√≠nseca del proceso es significativamente menor que la amplitud de las especificaciones. Un $C_p$ mayor a 1.33 es generalmente considerado **altamente adecuado** para el trabajo, lo que significa que el proceso puede cumplir consistentemente con los l√≠mites de dureza Brinell establecidos.\n\nEl **√≠ndice de capacidad real del proceso ($C_{pk}$) de 1.59** confirma la **gran capacidad del proceso**. Este valor, determinado por el $C_{pU}$ (1.59 vs $C_{pL}$ 2.11), revela que el proceso est√° **bien centrado** dentro de los l√≠mites de especificaci√≥n, aunque con una ligera tendencia hacia el l√≠mite superior. Un $C_{pk}$ superior a 1.33 es una se√±al de un proceso **altamente capaz y robusto**, con un riesgo muy bajo de producir mediciones de dureza fuera de las especificaciones.\n\nEl **√≠ndice de capacidad de Taguchi ($C_{pm}$) de 1.46** corrobora la **solidez del proceso** al considerar no solo la variabilidad y la centraci√≥n, sino tambi√©n la desviaci√≥n respecto al valor objetivo (Target = 550 kg/mm¬≤). Este valor alto sugiere que la salida del proceso (media observada de 557.0476 kg/mm¬≤) est√° razonablemente cerca del objetivo, y la variabilidad es baja, lo que garantiza una alta calidad y consistencia.\n\nLa **porci√≥n ca√≠da esperada (Exp<LSL 0% y Exp>USL 0%) es de 0%** en ambos lados de las especificaciones. Esto significa que se espera que **ninguna de las mediciones de dureza Brinell** est√© fuera de los l√≠mites de especificaci√≥n. La **porci√≥n observada fue tambi√©n del 0%** (`Obs<LSL 0%`, `Obs>USL 0%`) en las 21 muestras, lo que refuerza la conclusi√≥n de que el proceso es **extremadamente capaz y estable**, produciendo constantemente resultados dentro de los requisitos de dureza.\n\n:::\n::::\n\n## Diagrama de control para la Media($\\bar{X}$) y la Desviaci√≥n Est√°ndar($S$) con tama√±o de muestra variable\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dxstmv .Example}\n## Aplicaci√≥n de los Diagramas $\\bar{x}$ y $S$ con tama√±o de muestra variable. {#sec-ejemplo-diagrama-xstmv}\n\n<br/>Una empresa de producci√≥n de alimentos se encuentra interesada en supervisar la concentraci√≥n de un conservante en los productos que ofrece, para ello toman entre 10 y 15 muestras de 20 lotes de producci√≥n distintos, midiendo la concentraci√≥n del conservante en su respectiva unidad.\n\nLa @tbl-datos-ejemplo-dxstmv muestra las medias y las desviaciones que present√≥ cada lote inspeccionado, junto con su la cantidad de muestras que se tom√≥ en el lote correspondiente. Este ejemplo fue tomado de @rendon2013control.\n\n```{r}\n#| label: tbl-datos-ejemplo-dxstmv\n#| tbl-cap: \"N√∫mero total de defectos en cada unidad de inspecci√≥n\"\n#| tbl-align: left\n#| tbl-colwidths: [20,40]\n\ndatos_xstmv <- tibble(\n  obs=c(1:20),\nmedias=c(1.76, 1.55, 1.79, 1.73, 1.74, 1.68, 1.84, 1.88, 1.83, 1.89, 1.76, 1.76, 1.85, 1.51, 2.08, 1.85, 1.69, 1.90, 1.84, 1.62\n  ),\ndes=c(0.486, 0.508, 0.396, 0.622, 0.484, 0.377, 0.532, 0.424, 0.527, 0.409, 0.443, 0.403, 0.578, 0.409, 0.424, 0.479, 0.438, 0.429, 0.484, 0.434\n  ),\ntamano=c(11L, 12L, 14L, 14L, 10L, 15L, 13L, 12L, 14L, 11L, 12L, 15L, 10L, 13L, 14L, 11L, 10L, 12L, 15L, 13L\n  )\n)\n\nknitr::kable(\n  datos_xstmv,\n  booktabs = TRUE,\n  format = \"html\",\n  col.names = c(\n    \"Lote\", \"Media\", \"Desviaci√≥n\", \"Tama√±o\"\n  ),\n  align = \"cc\",\n  escape = FALSE,\n) \n```\n\nPara la construcci√≥n del diagrama de control, se utilizar√° el criterio del tama√±o de muestra promedio, calculado de la siguiente forma:\n\n$$\n\\begin{equation}\n\\bar{n}= \\frac{\\sum_{i=1}^{m}n_i}{m}\n\\end{equation}\n$$ {#eq-tmp}\n\nEn R, el calculo se realiza de la siguiente forma:\n\n```{r}\n#| label: npro\nsumn <- sum(datos_xstmv$tamano)\nm <- 20\nnpro <- round(sumn/m,0)\npaste(npro)\n```\n\nLos limites de control para el diagrama $S$ se obtienen de la siguiente forma: \n$$\n\\begin{align*}\nLCI & = B_{3}\\left(\\bar{n} \\right)\\,\\bar{S} \\\\\nLC & = \\bar{S} \\\\\nLCS & = B_{4}\\left(\\bar{n} \\right)\\,\\bar{S} \n\\end{align*}\n$$ {#eq-lstmv}\n\nDel mismo, se calculan con R utilizando el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-Sbarratmv\n\nB_3 <- ifelse(\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(npro)^2) / SixSigma::ss.cc.getc4(npro) < 0, 0,\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(npro)^2) / SixSigma::ss.cc.getc4(npro)\n)\nB_4 <- 1 + 3 * sqrt(1 - SixSigma::ss.cc.getc4(npro)^2) / SixSigma::ss.cc.getc4(npro)\n\nmedia_est <- mean(datos_xstmv$medias)\nS_barra <- mean(datos_xstmv$des)\nlci_S <- B_3 * S_barra\nlc_S <- S_barra\nlcs_S <- B_4 * S_barra\npaste0(\"LCI = \", formato(lci_S), \"    LC = \", formato(lc_S), \"    LCS = \", formato(lcs_S))\n\n```\n\nLos limites de control para $\\bar{x}$ vienen dados por la siguiente expresi√≥n:\n\n$$\n\\begin{align*}\nLCI & = \\bar{\\bar{x}} - A_{3}\\left(\\bar{n} \\right)\\,\\bar{S}  \\\\\nLC & = \\bar{\\bar{x}} \\\\\nLCS & = \\bar{\\bar{x}} + A_{3}\\left(\\bar{n} \\right)\\,\\bar{S}\n\\end{align*}\n$$ {#eq-lcxtmv}\n\nEn R, el calculo se realiza mediante el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-xbarra3\n\nA_3 <- 3 / (sqrt(npro) * SixSigma::ss.cc.getc4(npro))\nlci <- media_est - A_3 * S_barra\nlc <-  media_est\nlcs <- media_est + A_3 * S_barra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nLa representaci√≥n gr√°fica de este diagrama se observa en la @fig-dcxbarraStmv-qcc:\n\n```{r}\n#| label: fig-dcxbarraStmv-qcc\n#| fig-cap: \"Diagramas $\\\\bar{x}$ y $S$ para la cantidad de conservante por lote con el paquete `qcc`\"\n#| fig-subcap:\n#|   - \"Diagrama $S$ inicial\"\n#|   - \"Diagrama $\\\\bar{x}$ inicial\"\n#| layout-ncol: 2\n\n# Diagrama S en la fase 1\nS1 <- qcc(\n  datos_xstmv$des,sizes = npro,limits = c(lci_S, lcs_S),\n  type = \"S\", plot = FALSE\n)\nplot(\n  S1,\n  add.stats = FALSE, label.limits = c(\"LCI\", \"LCS\"),\n  title = \"\", xlab = \"Lote\", ylab = \"Desviaci√≥n est√°ndar\",\n  chart.all = TRUE\n)\n\n# Diagrama xbarra en la fase 1\nxbarra_xs2 <- qcc(\n  datos_xstmv$medias, sizes = npro,limits = c(lci, lcs),\n  type = \"xbar\",\n  plot = FALSE\n)\nplot(\n  xbarra_xs2,\n  add.stats = FALSE, label.limits = c(\"LCI\", \"LCS\"),\n  title = \"\", xlab = \"Lote\", ylab = \"Medias\",\n  chart.all = TRUE\n)\n\n```\n\n```{r}\n#| label: fig-dcxbarraStmv-highcharter\n#| fig-cap: \"Diagrama $S$ para la cantidad de conservante por lote con `highcharter`\"\n#| echo: false\n#| include: false\n\n# highchart() |>\n#   hc_add_series(\n#     data = datos_xstmv,\n#     hcaes(x = obs, low = lcs, high = lc),\n#     step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n#     type = \"arearange\", fillOpacity = 0.2, name = \"Rango Superior\", color = \"green\",\n#     showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n#   ) |>\n#   hc_add_series(\n#     data = datos_xstmv,\n#     hcaes(x = obs, low = lci, high = lc),\n#     step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n#     type = \"arearange\", fillOpacity = 0.2, name = \"Rango Inferior\", color = \"blue\",\n#     showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", hcaes(x = obs, y = lcs), useHTML = TRUE,\n#     color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n#     step = \"hv\", marker = list(enabled = FALSE),\n#     tooltip = list(valueDecimals = 4) # Ajusta los decimales seg√∫n la precisi√≥n de tus datos\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", hcaes(x = obs, y = lc), useHTML = TRUE,\n#     color = \"blue\", name = \"<b><i>LC</b></i>\",\n#     step = \"hv\", marker = list(enabled = FALSE),\n#     tooltip = list(valueDecimals = 4)\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", hcaes(x = obs, y = lci), useHTML = TRUE,\n#     color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n#     step = \"hv\", marker = list(enabled = FALSE),\n#     tooltip = list(valueDecimals = 4)\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", color = \"black\",\n#     hcaes(x = obs, y = des), # 'des' es la columna de desviaci√≥n est√°ndar/rango\n#     marker = list(radius = 3),\n#     useHTML = TRUE, name = \"<b><i>S<sub>i</sub></i></b>\",\n#     dashStyle = \"Solid\", # O \"Dash\" si prefieres\n#     tooltip = list(valueDecimals = 4)\n#   ) |>\n#   hc_xAxis(\n#     title = list(\n#       useHTML = TRUE,\n#       text = \"<b><i>Lote</b></i><br>\"\n#     )\n#   ) |>\n#   hc_yAxis(\n#     title = list(\n#       useHTML = TRUE,\n#       text = \"<b><i>Desviaci√≥n est√°ndar (S<sub>i</sub>)</b></i><br>\"\n#     )\n#   ) |>\n#   hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n#   hc_plotOptions(series = list(animation = FALSE)) |>\n#   hc_title(text = \"Diagrama S inicial\") # T√≠tulo para el sub-gr√°fico\n```\n\n\nSe observa que tanto el diagrama de control de la **desviaci√≥n est√°ndar ($S$)** como el diagrama de control de la **media ($\\bar{X}$)**, como se muestra en la Figura @fig-dcxbarraStmv-qcc, tienen **todos sus puntos dentro de los l√≠mites de control**.\n\nEsto indica que la **variabilidad del proceso** est√° bajo control estad√≠stico, permitiendo utilizar la estimaci√≥n de $\\sigma$ (la desviaci√≥n est√°ndar del proceso) para el monitoreo futuro. De manera similar, el **centro del proceso** tambi√©n est√° bajo control estad√≠stico, operando bajo causas fortuitas. Por lo tanto, la estimaci√≥n de $\\mu$ (la media del proceso) puede emplearse para supervisar las futuras concentraciones de conservantes en los alimentos producidos.\n\nEn resumen, el proceso de concentraci√≥n de conservantes en los alimentos se encuentra en **estado de control estad√≠stico**, tanto en su variabilidad como en su promedio, lo que permite la utilizaci√≥n de las estimaciones actuales para su supervisi√≥n y mejora continua.\n\n### Capacidad del Proceso\n\nPara determinar la capacidad del proceso estabilizado, se informa que la especificaci√≥n superior (LSE) para la concentraci√≥n de conservante es de 2.0 y la especificaci√≥n inferior (LIE) es de 1.0. Con estos datos y las propiedades del proceso que has determinado (media del proceso revisada y desviaci√≥n est√°ndar estimada a partir del rango promedio revisado), calcula los √≠ndices de capacidad del proceso ($C_p$ y  $C_{pk}$) y eval√∫a qu√© tan bien est√° operando el proceso en relaci√≥n con las especificaciones.\n\nLos l√≠mites de tolerancia natural fueron los establecidos anteriormente, siendo estos $`r formato(lci)`$ y $`r formato(lcs)`$. \n\n```{r}\n#| label: fig-xstmv-cp\n#| fig-cap: \"Capacidad del proceso\"\n\nX_bar <- datos_xstmv$medias\nS <- datos_xstmv$des\n# Establecer los l√≠mites de especificaci√≥n\nspec.limits <- c(1, 2)\n\n# Calcular la media del rango revisada\nS_barra <- mean(S)\n\n# ESTO ES CR√çTICO: Estimar la desviaci√≥n est√°ndar del proceso (sigma) a partir de R_barra\n# Usamos d2(n) para convertir el rango promedio en una estimaci√≥n de sigma\nsd_estimado_proceso <- S_barra / SixSigma::ss.cc.getd2(npro)\n\nxbar_chart_obj <- qcc(X_bar, type = \"xbar\", sizes = npro, plot = FALSE,\n                      std.dev = sd_estimado_proceso)\ncapability <- process.capability(xbar_chart_obj, spec.limits = spec.limits , print = FALSE)\n\n# Calcular la porci√≥n ca√≠da (esto deber√≠a ser consistente con 'capability$exp' ahora)\n# mean_data es la media del proceso\nmean_data <- mean(X_bar) # Usar la media de las X_bar revisadas\n\nlower_limit <- spec.limits[1]\nupper_limit <- spec.limits[2]\n\n# Proporci√≥n de unidades por debajo del l√≠mite inferior\nportion_below <- pnorm(lower_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Proporci√≥n de unidades por encima del l√≠mite superior\nportion_above <- 1 - pnorm(upper_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Porci√≥n ca√≠da total\nportion_fallen <- portion_below + portion_above\n\nportion_fallen <- sum(capability$exp)\n\n# Mostrar la porci√≥n ca√≠da\ncat(\"Porci√≥n ca√≠da:\", formato(portion_fallen), \"\\n\")\n```\n\nEl an√°lisis de capacidad del proceso para la **concentraci√≥n de conservantes** en los productos alimenticios revela un desempe√±o con **oportunidades significativas de mejora**. \n\nEl **√≠ndice de capacidad potencial del proceso ($C_p$) de 1.2** indica una capacidad potencial **aceptable, pero no √≥ptima**. Esto sugiere que la variabilidad intr√≠nseca del proceso, si estuviera perfectamente centrado, apenas cabe dentro de la amplitud de las especificaciones. Aunque un $C_p$ de 1.2 est√° por encima del umbral de 1.0 (que Montgomery considera \"no adecuado\"), a√∫n **no alcanza los niveles deseables de 1.33 o 1.67** para procesos de clase mundial, lo que significa que la variabilidad es a√∫n considerable en relaci√≥n con la tolerancia.\n\nEl **√≠ndice de capacidad real del proceso ($C_{pk}$) de 0.533** es la **principal preocupaci√≥n** en este an√°lisis. Al ser significativamente menor que 1.0, y en este caso determinado por $C_{pU}$ (0.533 vs $C_{pL}$ 1.86), revela que el proceso est√° **mal centrado** y muestra una **fuerte tendencia hacia el L√≠mite Superior de Especificaci√≥n (USL)**. Este valor, muy por debajo de 1.0, confirma que el proceso **no es capaz** de cumplir consistentemente con los requisitos de concentraci√≥n, ya que una parte sustancial de la distribuci√≥n se extiende m√°s all√° del l√≠mite superior.\n\nEl **√≠ndice de capacidad de Taguchi ($C_{pm}$) de 0.537** corrobora la **deficiencia del proceso**. Este valor, cercano al $C_{pk}$, refleja que la desviaci√≥n del proceso no solo es notable en relaci√≥n con las especificaciones, sino que tambi√©n est√° **desalineado con el valor objetivo (Target = 1.5)**. La media del proceso (1.7775) se ha desplazado considerablemente del objetivo, lo que penaliza fuertemente este √≠ndice y refuerza la necesidad urgente de reajustar la centraci√≥n del proceso.\n\nLa **porci√≥n ca√≠da esperada (Exp>USL 5.5%) es de 5.5%** por encima del l√≠mite superior. Esto significa que aproximadamente el **5.5%** de los lotes de producci√≥n se espera que tengan una concentraci√≥n de conservante por encima del l√≠mite permitido. Aunque la **porci√≥n observada fue del 0%** por debajo del LSL y **5%** por encima del USL en las 20 muestras (`Obs<LSL 0%`, `Obs>USL 5%`), la alta expectativa de defectos subraya la importancia cr√≠tica de implementar medidas correctivas inmediatas para **reducir la concentraci√≥n promedio y su variabilidad**, asegurando as√≠ que los productos cumplan con las normativas de conservantes.\n:::\n::::\n\n## Diagrama de Control Para Observaciones Individuales\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dcmr .Example}\n### Aplicaci√≥n del diagrama de control $MR$ {#sec-ejemplo-diagrama-mr}\n\n<br/>En el departamento de sistemas se lleva un registro del tiempo de respuesta a solicitudes de servicio de clientes internos. Los √∫ltimos datos en horas y en el orden de ocurrencia se muestran en la @tbl-datos-tiempo_respuesta_solicitudes. Obtenga los l√≠mites de control para una carta de control de individuales e interpr√©telos. Este ejemplo fue tomado de @gutierrez2009control.\n\n```{r}\n#| label: tbl-datos-tiempo_respuesta_solicitudes\n#| tbl-cap:  \"Registros del tiempo de respuesta a solicitudes de servicio de clientes internos\"\nresponse_times <- c(\n  39, 35, 49, 92, 41, 57, 38, 37, 33, 33, 44, 34, 119, 37,\n  34, 32, 34, 23, 96, 43, 36, 32, 35, 42, 42, 34, 86, 27,\n  42, 117, 33, 39, 43, 37, 78, 42, 37, 37, 33, 96, 26, 37,\n  29, 32, 38, 98, 39, 43, 126, 87, 46, 31, 109, 37, 40, 37,\n  28, 52, 122, 40, 29, 33, 35, 71, 62\n)\n\n# Create a dataframe for individual observations\n# For individual charts, each observation is a \"subgroup\" of size 1.\n# We'll create an index for each observation.\nindividual_times <- data.table::data.table(\n  check.names = FALSE,\n  Observacion = 1:length(response_times),\n  Tiempo_Respuesta_Horas = response_times\n) |>\n  dplyr::mutate(\n    MR = c(NA, abs(diff(Tiempo_Respuesta_Horas)))\n  ) |>\n  data.table::data.table()\n\noptions(\n  reactable.language = reactableLang(\n    searchPlaceholder = \"Buscar\",\n    pageNext = \"Siguiente\",\n    pagePrevious = \"Anterior\",\n    noData = \"Ninguna fila encontrada\",\n    pageInfo = \"{rowStart} de {rowEnd} de {rows} filas\"\n  )\n)\n\nreactable::reactable(\n  individual_times,\n  # defaultColDef = colDef(\n  #   headerStyle = list(background = \"#f7f7f8\")\n  # ),\n  columns = list(\n    Observacion = colDef(header = \"N√∫mero de Observacion\", align = \"right\"),\n    Tiempo_Respuesta_Horas = colDef(\n      header = \"Tiempo de respuesta \\\\(\\\\left( x_{i} \\\\right) \\\\)\", \n      align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 2, locales = \"es-ES\"\n      )\n    ),\n    MR = colDef(\n      header = \"Rango M√≥vil \\\\(\\\\left({MR}_{i}\\\\right)\\\\)\", \n      align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 2, locales = \"es-ES\"\n      )\n    )\n  ),\n  striped = TRUE,\n  bordered = TRUE,\n  highlight = TRUE,\n  filterable = TRUE,\n  minRows = 10\n)\n```\n\nPara estimar los parametros del diagrama es necesario calcular la media de la variable de interes, en este caso el tiempo de respuesta, y la media de los rangos moviles, este calculo es bastante sencillo, teniendo entonces $\\bar{x}$= `r formato(mean(individual_times$Tiempo_Respuesta_Horas))` y $\\overline{MR}$= `r formato(mean(individual_times$MR,na.rm = TRUE))` \n\nLos limites para el diagrama $x$ inicial se calculan de la siguiente forma:\n\n$$\n\\begin{align*}\nLCS  & =  \\bar{x} + 2,6596 \\, \\overline{MR} \\\\\nLC  & =  \\bar{x} \\\\\nLCI  & = \\bar{x} - 2,6596\\, \\overline{MR} \n\\end{align*}\n$$ {#eq-lsxmr}\n\nMediante R, se calculan utilizando el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-x\n\nxbarra <- mean(individual_times$Tiempo_Respuesta_Horas)\nMRbarra <- mean(individual_times$MR, na.rm = TRUE)\ndesviacion <- MRbarra / 1.128\n\nlci <- xbarra - 2.6596 * MRbarra\nlc <-  xbarra\nlcs <- xbarra + 2.6596 * MRbarra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nManualmente, estos limites se calculan de la siguiente forma:\n\n$$\n\\begin{align*}\nLCS  & =  \\bar{x} + 2,6596 \\, \\overline{MR} = `r formato(xbarra)`+2,6596*`r formato(MRbarra)`= `r formato(lcs)` \\\\\nLC  & =  \\bar{x} = `r formato(lc)` \\\\ \nLCI  & = \\bar{x} - 2,6596\\, \\overline{MR} = `r formato(xbarra)`-2,6596*`r formato(MRbarra)`= `r formato(lci)`\n\\end{align*}\n$$\nLos limites para el diagrama inicial $MR$ se obtienen de la siguiente forma:\n$$\n\\begin{align*}\nLCS  & = 3,2677 \\, \\overline{MR}\\\\\nLC  & = \\overline{MR} \\\\\nLCI  & = 0\n\\end{align*}.\n$$ {#eq-lsxmr1}\n\nUtilizando Rstudio, se calculan utilizando el siguiente bloque de c√≥digo: \n\n```{r}\n#| label: lci-MR\n\nlci_MR <- 0\nlc_MR <- MRbarra\nlcs_MR <- 3.2677 * MRbarra\npaste0(\n  \"LCI = \", formato(lci_MR), \"    LC = \", formato(lc_MR), \"    LCS = \", formato(lcs_MR)\n)\n```\n\nManualmente, se obtienen mediante el siguiente calculo:\n\n$$\n\\begin{align*}\nLCS  & = 3,2677 \\, \\overline{MR}= 3,2677*`r formato(MRbarra)`= `r formato(lcs_MR)`\\\\\nLC  & = \\overline{MR} = `r formato(lc_MR)` \\\\ \nLCI  & = 0\n\\end{align*}.\n$$\nLa estimaci√≥n de la desviaci√≥n viene dada por la siguiente expresi√≥n:\n\n$$\n\\begin{equation}\n\\hat{\\sigma}=\\frac{\\overline{\\textit{MR}}}{1,1284} = \\frac{`r MRbarra`}{1,1284}=`r formato(desviacion)`\n\\end{equation}\n$$\n\nUna vez los limites de control, ya es posible graficar los diagramas de control. Los cuales se pueden observar a continuacion:\n\n```{r}\n#| label: fig-MRinicial-highcharter\n#| fig-cap: \"Diagrama $\\\\textit{MR}$ inicial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc_MR, high = lcs_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci_MR, high = lc_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc_MR), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\",\n    hcaes(x = Observacion, y = MR),\n    marker = list(radius = 3),useHTML = TRUE, \n    name = \"<b><i>MR<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de Observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango m√≥vil (MR<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar en la @fig-MRinicial-highcharter, el diagrama de control $MR$ inicial muestra que **todos los puntos est√°n dentro de los l√≠mites de control**, lo que indica que el proceso est√° bajo control estad√≠stico. Esto significa que la variabilidad del proceso es consistente y no hay evidencia de causas especiales que afecten el rango m√≥vil entre observaciones consecutivas.\n\n```{r}\n#| label: fig-x-inicial-highcharter\n#| fig-cap: \"Diagrama $x$ incial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc, high = lcs),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci, high = lc),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\", \n    hcaes(x = Observacion, y = Tiempo_Respuesta_Horas),\n    marker = list(radius = 3),  useHTML = TRUE, \n    name = \"<b><i>x<sub>i</sub></i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Tiempo de respuesta de solicitudes  (x<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nEl diagrama de control $x$ inicial, como se muestra en la @fig-x-inicial-highcharter, indica que el punto numero 49 esta fuera de los limites de control. Esto sugiere que el proceso de respuesta a solicitudes de servicio no est√° bajo control estad√≠stico, y la media del tiempo de respuesta no es consistente a lo largo del tiempo.\n\nSe calculan nuevamente los limites para el diagrama $x$ y $MR$ eliminando el punto 49, que es el √∫nico punto fuera de los limites de control:\n\n```{r}\n#| label: lci-MR-pre-def\nindividual_times1 <- individual_times[-49]\nxbarra <- mean(individual_times1$Tiempo_Respuesta_Horas)\nMRbarra <- mean(individual_times1$MR, na.rm = TRUE)\ndesviacion <- MRbarra / 1.128\n\nlci <- xbarra - 2.6596 * MRbarra\nlc <-  xbarra\nlcs <- xbarra + 2.6596 * MRbarra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nLos nuevos limites para el diagrama $x$ son:\n\n```{r}\n#| label: lci-x-pre-def\nlci_MR <- 0\nlc_MR <- MRbarra\nlcs_MR <- 3.2677 * MRbarra\npaste0(\n  \"LCI = \", formato(lci_MR), \"    LC = \", formato(lc_MR), \"    LCS = \", formato(lcs_MR)\n)\n```\n\n```{r}\n#| label: fig-MRinicial-highcharter-pre-def\n#| fig-cap: \"Diagrama $\\\\textit{MR}$ inicial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lc_MR, high = lcs_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lci_MR, high = lc_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lcs_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", hcaes(x = Observacion, y = lc_MR), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lci_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", color = \"black\",\n    hcaes(x = Observacion, y = MR),\n    marker = list(radius = 3),useHTML = TRUE, \n    name = \"<b><i>MR<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de Observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango m√≥vil (MR<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\n\n```{r}\n#| label: fig-x-inicial-highcharter-pre-def\n#| fig-cap: \"Diagrama $x$ incial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lc, high = lcs),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lci, high = lc),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lcs), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", hcaes(x = Observacion, y = lc), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lci), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", color = \"black\", \n    hcaes(x = Observacion, y = Tiempo_Respuesta_Horas),\n    marker = list(radius = 3),  useHTML = TRUE, \n    name = \"<b><i>x<sub>i</sub></i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Tiempo de respuesta de solicitudes  (x<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nAl observar la @fig-x-inicial-highcharter-pre-def se tiene que el punto 59 esta fuera de control. A partir de este paso se requieren de una serie de iteraciones para poder obtener un diagrama de control $x$ y $MR$ que cumpla con los requisitos de control estad√≠stico. Se utilizo en la parte de analisis del statgraphics correspondiente para el analisis de este diagrama, que exluyera automaticamente segun hubieran puntos fuera de control. Este proceso iterativo determino que las mediciones excluidas son la 4,5,6,7,8,9,10,13,19,20, 27,28,30,31,32,35,40,41,46,49,50,53,58,59,64 y 65.\n\nSe calculan nuevamente los limites para el diagrama $x$ y $MR$ eliminando los puntos fuera de control, que son los puntos 4,5,6,7,8,9,10,13,19,20,27,28,30,31,32,35,40,41,46,49,50,53,58,59,64 y 65:\n\n```{r}\n#| label: lci-MR-def\nindividual_times <- individual_times[-c(4,5,6,7,8,9,10,13,19,20,27,28,30,31,32,35,40,41,46,49,50,53,58,59,64,65)]\n\nxbarra <- mean(individual_times$Tiempo_Respuesta_Horas)\nMRbarra <- mean(individual_times$MR, na.rm = TRUE)\ndesviacion <- MRbarra / 1.128\n\nlci <- xbarra - 2.6596 * MRbarra\nlc <-  xbarra\nlcs <- xbarra + 2.6596 * MRbarra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nLos nuevos limites para el diagrama $x$ son:\n\n```{r}\n#| label: lci-x-def\nlci_MR <- 0\nlc_MR <- MRbarra\nlcs_MR <- 3.2677 * MRbarra\npaste0(\n  \"LCI = \", formato(lci_MR), \"    LC = \", formato(lc_MR), \"    LCS = \", formato(lcs_MR)\n)\n```\n\nSe grafican los diagramas de control $x$ y $MR$ con los nuevos limites de control:\n\n```{r}\n#| label: fig-MRinicial-highcharter-def\n#| fig-cap: \"Diagrama $\\\\textit{MR}$ inicial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc_MR, high = lcs_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci_MR, high = lc_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc_MR), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\",\n    hcaes(x = Observacion, y = MR),\n    marker = list(radius = 3),useHTML = TRUE, \n    name = \"<b><i>MR<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de Observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango m√≥vil (MR<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\n\n\n```{r}\n#| label: fig-x-inicial-highcharter-def\n#| fig-cap: \"Diagrama $x$ incial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc, high = lcs),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci, high = lc),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\", \n    hcaes(x = Observacion, y = Tiempo_Respuesta_Horas),\n    marker = list(radius = 3),  useHTML = TRUE, \n    name = \"<b><i>x<sub>i</sub></i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Tiempo de respuesta de solicitudes  (x<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\n### Capacidad del Proceso\n:::\n::::\n","srcMarkdownNoYaml":"\n\n# Diagramas de control para variables\n\nLos diagramas de control para variables son herramientas gr√°ficas del Control Estad√≠stico de Procesos (CEP) que se usan para monitorear y analizar un proceso a lo largo del tiempo. Su objetivo principal es distinguir entre las variaciones comunes (aleatorias e inherentes al proceso) y las variaciones especiales o asignables (causadas por eventos espec√≠ficos e inesperados).\n\nEstos diagramas se aplican a caracter√≠sticas de calidad que se pueden medir en una escala continua, como:\n\n-   Peso de un producto.\n\n-   Longitud o di√°metro de una pieza.\n\n-   Temperatura de un horno.\n\n-   Tiempo de un ciclo de producci√≥n.\n\n## ¬øC√≥mo funcionan? \n\nüìà Un diagrama de control para variables grafica los datos de tu proceso en una secuencia de tiempo. T√≠picamente, consta de tres l√≠neas horizontales:\n\n**L√≠nea Central (LC)**: Representa el promedio hist√≥rico o el valor objetivo de la caracter√≠stica que se est√° midiendo. Es el rendimiento esperado del proceso.\n\n**L√≠mite de Control Superior (LCS)**: Se ubica tres desviaciones est√°ndar por encima de la l√≠nea central.\n\n**L√≠mite de Control Inferior (LCI)**: Se ubica tres desviaciones est√°ndar por debajo de la l√≠nea central.\n\nLa idea es que, si un proceso es estable y solo presenta variaciones comunes, casi todos los puntos graficados se encontrar√°n dentro de estos l√≠mites de control y distribuidos de manera aleatoria alrededor de la l√≠nea central.\n\nUn punto fuera de los l√≠mites de control o un patr√≥n no aleatorio (como una tendencia ascendente, 7 puntos seguidos de un mismo lado de la l√≠nea central, etc.) es una se√±al de que existe una causa especial de variaci√≥n. Esto indica que algo inusual ha ocurrido y que el proceso est√° \"fuera de control\", lo que requiere una investigaci√≥n para identificar y corregir el problema.\n\n## Tipos m√°s comunes \n\nGeneralmente, se usan en pares para monitorear tanto la tendencia central como la dispersi√≥n (variabilidad) del proceso:\n\n**Gr√°fica** $\\bar{X}‚àíR$ **(Medias y Rangos)**: Es la m√°s com√∫n. La gr√°fica $\\bar{X}$ (de medias) monitorea el promedio del proceso, mientras que la gr√°fica $R$ (de rangos) monitorea la variabilidad dentro de las muestras. Se usa t√≠picamente con tama√±os de muestra peque√±os (entre 2 y 10).\n\n**Gr√°fica** $\\bar{X}‚àíS$ **(Medias y Desviaci√≥n Est√°ndar)**: Similar a la anterior, pero la gr√°fica $S$ usa la desviaci√≥n est√°ndar en lugar del rango para medir la variabilidad. Es estad√≠sticamente m√°s robusta y se prefiere cuando los tama√±os de muestra son m√°s grandes (mayores a 10).\n\n**Gr√°fica** $I-MR$ **(Individuales y Rango M√≥vil)**: Se utiliza cuando solo se tiene una medici√≥n por cada punto en el tiempo (tama√±o de muestra = 1), como en procesos lentos o donde la medici√≥n es costosa o destructiva.\n\nEn el siguiente bloque de c√≥digo se cargan todas las librer√≠as o paquetes necesarios para el desarrollo de este capitulo, si no se tiene instalado alguno de ellos se instalaran autom√°ticamente. \n\n```{r}\n#| label: carga-paquetes-necesarios\n#| include: false\nif (!requireNamespace(\"pacman\", quietly = TRUE)) install.packages(\"pacman\")\nlibrary(pacman)\npacman::p_load(ggplot2,ggfortify, DT, reshape2, knitr,  tidyverse, ggQC, pammtools, latex2exp, data.table, reactable, htmlwidgets, htmltools, highcharter, tinytex, qcc, kableExtra)\n```\n\nDel mismo modo, se crea una base de datos bib para los paquetes de R que se est√°n utilizando en este capitulo, la cual se puede usar para crear una bibliograf√≠a al final del capitulo.\n\n```{r}\n#| include: false\n#| label: creacion-bibliografias\n\n# Crear automaticamente una base de datos bib para los paquetes de R \nknitr::write_bib(\n  c(\n    .packages(), \"knitr\", \"tidyverse\", \"qcc\", \"ggQC\", \"plotly\",\n    \"highcharter\", \"kableExtra\", \"data.table\", \"pacman\",\n    \"renv\", \"pammtools\", \"htmlwidgets\", \"htmltools\", \"data.table\",\n    \"RColorBrewer\", \"latex2exp\", \"tinytex\", \"reactable\"\n  ),\n  \"packages.bib\"\n)\n\n```\n\nPor otro lado, aqui se crean funciones propias para darle formato a las salidas imprimidas en pantalla. las cuales se pueden usar en cualquier parte del capitulo.\n\n```{r}\n#| label: funciones-creadas\n#| include: false\n\n# funcion para ajustar fill-opacity usando css\nfillOpacity <- function(., alpha = 0.5) {\n  css <- sprintf(\"<style> .js-fill { fill-opacity: %s}\n!important; } </style>\", alpha)\n  prependContent(., HTML(css))\n}\n\n# funcion para dar formato a numero\nformato <- function(x, digits = 4) {\n  if (!is.numeric(x)) stop(\"¬°La entrada debe ser numerica!\")\n  format(\n    round(x, digits = digits),\n    mode = \"double\",\n    big.mark = \".\",\n    decimal.mark = \",\"\n  )\n}\n\n```\n\n## Diagrama de control para la Media($\\bar{X}$) y el Rango($R$)\nLos diagramas de control para la media ($\\bar{X}$) y el rango ($R$) son herramientas fundamentales en el Control Estad√≠stico de Procesos (CEP). Estos diagramas permiten monitorear la tendencia central y la variabilidad de un proceso a lo largo del tiempo, ayudando a identificar si el proceso est√° bajo control estad√≠stico o si existen causas asignables que afectan su desempe√±o. Los mismos seran ejemplificados a continuaci√≥n.\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dcxr .Example}\n### Aplicaci√≥n del diagrama de control para la Media($\\bar{X}$) y el Rango($R$) {#sec-ejemplo-diagrama-xr}\n\n<br/>Se van a establecer gr√°ficas de control para $\\bar{X}$ y $R$ en determinada dimensi√≥n, en mil√≠metros, de una parte. Se reunieron datos en tama√±os de subgrupo igual a 6, y se citan a continuaci√≥n en la @tbl-datos-peso-promedio-rango-parte. Determine la l√≠nea central y los l√≠mites de control tentativos. Suponga que hay causas asignables, y revise la l√≠nea central y los l√≠mites.Este ejemplo fue tomado de @besterfield1995control.\n\n```{r}\n#| label: tbl-datos-peso-promedio-rango-parte\n#| tbl-cap:  \"Mediciones del peso promedio y el rango en mil√≠metros de una parte\"\n#| tbl-colwidths: [20,50]\n# Creando vectoress para X barra y R\nX_bar <- c(20.35, 20.40, 20.36, 20.65, 20.20, 20.40, 20.43, 20.37, 20.48, 20.42, 20.39, 20.38, 20.40, 20.41, 20.45, 20.34, 20.36, 20.42, 20.50, 20.31, 20.39, 20.39, 20.40, 20.41, 20.40)\nR <- c(0.34, 0.36, 0.32, 0.36, 0.36, 0.35, 0.31, 0.34, 0.30, 0.37, 0.29, 0.30, 0.33, 0.36, 0.34, 0.36, 0.37, 0.73, 0.38, 0.35, 0.38, 0.33, 0.32, 0.34, 0.30)\n\n\n# Creando el dataframe\ndf <- data.frame(X_bar = X_bar, R = R)\n\ndatos <- df |>\n  dplyr::mutate(\n    muestra = 1:nrow(df)\n  ) |>\n  dplyr::rename(\n    media = X_bar, \n    rango = R     \n  ) |>\n  dplyr::relocate(\n    muestra,\n    .before = media\n  ) |>\n  data.table::as.data.table()\n\nformato <- function(x, digits = 4) {\n  formatC(x, format = \"f\", digits = digits, big.mark = \".\", decimal.mark = \",\")\n}\n\n# Configuraciones Reactable \noptions(\n  reactable.language = reactableLang(\n    searchPlaceholder = \"buscar...\",\n    pageNext = \"Siguiente\",\n    pagePrevious = \"Anterior\",\n    noData = \"No entries found\",\n    pageInfo = \"{rowStart} de {rowEnd} de {rows} filas\"\n  )\n)\n\n# Reactable tabla para los nuevos datos\nreactable::reactable(\n  datos,\n  list(\n    muestra = colDef(header = \"Muestra\", align = \"right\"),\n    media = colDef(\n      header = \"\\\\( \\\\bar{x}_i \\\\)\", align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 3, locales = \"es-ES\"\n      )\n    ),\n    rango = colDef(\n      header = \"\\\\( R_i \\\\)\", align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 3, locales = \"es-ES\"\n      )\n    )\n  ),\n  defaultColDef = colDef(align = \"center\"),\n  striped = TRUE,\n  bordered = TRUE,\n  highlight = TRUE\n)\n```\n\nUna vez observados los datos, Se proceder√° ahora a calcular los limites para ambos diagramas de control, para lo cual se usara el paquete `SixSigma` que contiene las constantes necesarias para calcular los limites de control, recordando que es un estudio inicial por lo que no se tienen ni los par√°metros ni estimaciones de los mismos. \n\nPrimeramente, para la construcci√≥n del diagrama $R$, se requiere determinar $D_{3}$ y $D_{4}$, lo cual se puede obtener de la respectiva tabla, teniendo en cuenta que $n=6$, o mediante el siguiente bloque de c√≥digo: \n\n```{r}\n#| label: d3-d4\n\nn <- 6 # Sample size\nD_3 <- ifelse(\n  1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n)) < 0, 0, 1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd3(n))\n)\nD_4 <- 1 + 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n\npaste0(\"D_3 = \", formato(D_3), \"   D_4 = \", formato(D_4))\n```\nDe manera que, el calculo de los l√≠mites de control vendr√≠a dado por la siguiente expresi√≥n: \n\n$$\n\\begin{align*}\nLCI & = D_{3}\\,\\bar{R}  \\\\\nLC & = \\bar{R}\\\\\nLCS & = D_{4}\\,\\bar{R} \n\\end{align*}\n$$ {#eq-lcxr}\n\nA continuaci√≥n se muestran los calculos en siguiente bloque de c√≥digo para el diagrama $R$:\n\n```{r}\n#| label: lci-Rbarra\nn <- 6 # Sample size \n\n# Calculate D3 and D4 using SixSigma package\nD_3 <- ifelse(\n  1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n)) < 0, 0, 1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n)\nD_4 <- 1 + 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n\n# Calculate the average of the ranges from your df\nR_barra <- mean(datos$rango)\n\n# Calculate the control limits\nlci_R <- R_barra * D_3\nlc_R <- R_barra\nlcs_R <- R_barra * D_4\n\n# Print the results\npaste0(\"LCI_R = \", formato(lci_R), \"    LC_R = \", formato(lc_R), \"    LCS_R = \", formato(lcs_R))\n\n```\nManualmente, el calculo es el siguiente:\n\n$$\n\\begin{align*}\nLCI & = D_{3}\\,\\bar{R} = `r D_3`*`r R_barra` = `r formato(lci_R)`  \\\\\nLC & = \\bar{R} = `r R_barra`  \\\\\nLCS & = D_{4}\\,\\bar{R} = `r formato(D_4)`*`r R_barra`  = `r formato(lcs_R)`\n\\end{align*}\n$$ \nLa estimaci√≥n de la varianza viene dada por: \n\n$$\n\\hat{\\sigma}=\\frac{\\bar{R}}{d_{2}}= \\frac{`r R_barra`}{`r formato(SixSigma::ss.cc.getd2(n))`} = `r formato(R_barra/SixSigma::ss.cc.getd2(n))`\n$$\nPara el diagrama $\\bar{x}$, los limites se obtienen mediante la siguiente formula:\n\n$$\n\\begin{align*}\nLCS & = \\bar{\\bar{x}} + A_2 \\bar{R} \\\\\nLC  & = \\bar{\\bar{x}} \\\\\nLCI & = \\bar{\\bar{x}} - A_2 \\bar{R}\n\\end{align*} \n$${#eq-lcx}\n\nIgualmente se calculan ahora los limites para el diagrama $\\bar{X}$, para lo cual se usara el paquete `SixSigma` que contiene las constantes necesarias para calcular los limites de control.\n\n```{r}\n#| label: lci-xbarra\n\nn <- 6\n\n# Calculate A_2 using SixSigma package\nA_2 <- 3 / (sqrt(n) * SixSigma::ss.cc.getd2(n))\n\n# Calculate the overall average of the sample means from your df\nmedia_est <- mean(datos$media) # This corresponds to X_double_bar\n\n# Calculate the control limits\nlci_X <- media_est - A_2 * R_barra\nlc_X <- media_est\nlcs_X <- media_est + A_2 * R_barra\n\n# Print the results\npaste0(\"LCI_X = \", formato(lci_X), \"    LC_X = \", formato(lc_X), \"    LCS_X = \", formato(lcs_X))\n```\nManualmente, los calculos se realizan de la siguiente forma: \n\n$$\n\\begin{align*}\nLCS & = \\bar{\\bar{x}} + A_2 \\bar{R} = `r formato(media_est)`+`r formato(A_2)`*`r R_barra`= `r formato(lcs_X)` \\\\\nLC  & = \\bar{\\bar{x}} = `r formato(lc_X)`\\\\\nLCI & = \\bar{\\bar{x}} - A_2 \\bar{R} = `r formato(media_est)`-`r formato(A_2)`*`r R_barra`= `r formato(lci_X)`\n\\end{align*} \n$$\n\nUna vez determinados los limites de control ya es posible realizar los diagramas de control respectivos con el paquete `highcharter`. Los cuales se pueden ver a continuaci√≥n:\n\n```{r}\n#| label: fig-R-highcharter\n#| fig-cap: \"Diagramas $R$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\n# Diagrama de Control para el Rango (Gr√°fico R)\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_R, high = lcs_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_R, high = lc_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_R), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = rango),\n    marker = list(\n      radius = 3, fillColor = \"blue\", symbol = \"circle\"\n    ),\n    useHTML = TRUE,\n    name = \"<b><i>R<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango (R<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nSe puede observar en la @fig-R-highcharter el rango asociado al subgrupo 18 se encuentra fuera de los limites de control, por lo que suponiendo causas asignables el proceso esta fuera de control estad√≠stico. Por lo que se tiene que recalcular los limites de control y construir nuevamente el diagrama $R$.\n\n```{r}\n#| label: fig-xbarra-highcharter\n#| fig-cap: \"Diagramas $\\\\bar{x}$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nSe puede observar igualmente en la @fig-xbarra-highcharter que aqui existen dos puntos consecutivos (4 y 5) fuera de los limites de control , por lo que suponiendo causas atribuibles el proceso se encuentra fuera de control estadistico. Por lo que se tiene que recalcular los limites de control y contruir nuevamente el diagrama $\\bar{X}$.\n\nLos limites para el diagrama $R$, serian ahora los siguientes:\n\n```{r}\n#| label: lci-Rbarra-def\ndatos <- datos[-c(4,5,18)]\n# Calculate D3 and D4 using SixSigma package\nD_3 <- ifelse(\n  1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n)) < 0, 0, 1 - 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n)\nD_4 <- 1 + 3 * (SixSigma::ss.cc.getd3(n) / SixSigma::ss.cc.getd2(n))\n\n# Calculate the average of the ranges from your df\nR_barra <- mean(datos$rango)\n\n# Calculate the control limits\nlci_R <- R_barra * D_3\nlc_R <- R_barra\nlcs_R <- R_barra * D_4\n\n# Print the results\npaste0(\"LCI_R = \", formato(lci_R), \"    LC_R = \", formato(lc_R), \"    LCS_R = \", formato(lcs_R))\n\n```\n\nPor otro lado, los limites para el diagrama $\\bar{X}$ son los siguientes:\n\n```{r}\n#| label: lci-xbarra-def\nn <- 6\n\n# Calculate A_2 using SixSigma package\nA_2 <- 3 / (sqrt(n) * SixSigma::ss.cc.getd2(n))\n\n# Calculate the overall average of the sample means from your df\nmedia_est <- mean(datos$media) # This corresponds to X_double_bar\n\n# Calculate the control limits\nlci_X <- media_est - A_2 * R_barra\nlc_X <- media_est\nlcs_X <- media_est + A_2 * R_barra\n\n# Print the results\npaste0(\"LCI_X = \", formato(lci_X), \"    LC_X = \", formato(lc_X), \"    LCS_X = \", formato(lcs_X))\n```\n\n```{r}\n#| label: fig-R-highcharter-def\n#| fig-cap: \"Diagramas $R$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_R, high = lcs_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_R, high = lc_R),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_R), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_R), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = rango),\n    marker = list(\n      radius = 3, fillColor = \"blue\", symbol = \"circle\"\n    ),\n    useHTML = TRUE,\n    name = \"<b><i>R<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango (R<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar ninguno de los puntos se encuentra fuera de los limites de control.\n\n```{r}\n#| label: fig-xbarra-highcharter-def\n#| fig-cap: \"Diagramas $\\\\bar{x}$ para el di√°metro interior (mm) de los anillos en la fase I con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = datos,\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nIgualmente, como se puede observar ninguno de los puntos se encuentra fuera de los limites de control. Por lo que, dado que para ambos diagramas de control (@fig-R-highcharter-def y @fig-xbarra-highcharter-def) no se encuentran ahora puntos fuera de control, se puede decir entonces que el proceso es estable o bajo control tanto en media como en varianza.\n\n### Capacidad del Proceso\n\nPara determinar la capacidad del proceso estabilizado, se informa que la especificaci√≥n superior (LSE) para la dimensi√≥n de la parte es de 20.80 mm y la especificaci√≥n inferior (LIE) es de 20.00 mm. Con estos datos y las propiedades del proceso que has determinado (media del proceso revisada y desviaci√≥n est√°ndar estimada a partir del rango promedio revisado), calcula los √≠ndices de capacidad del proceso ($C_p$ y  $C_{pk}$) y eval√∫a qu√© tan bien est√° operando el proceso en relaci√≥n con las especificaciones.\n\nPara empezar, una vez determinado que el proceso se encuentra bajo control estadistico , se procede a calcular los indices de capacidad del proceso, por este motivo se supondr√° que los datos siguen una distribuci√≥n normal. \n\nLos limites de tolerancia natural fueron los establecidos anteriormente, siendo estos $`r formato(lci_X)`$ y $`r formato(lcs_X)`$.\n\n\n```{r}\n#| label: fig-xr-cp\n#| fig-cap: \"Capacidad del proceso\"\nX_bar <- datos$media \nR <- datos$rango     \n\n# Establecer los l√≠mites de especificaci√≥n\nspec.limits <- c(20, 20.80)\nn <- 6 # Tama√±o del subgrupo\n\n# Calcular la media del rango revisada\nR_barra <- mean(R)\n\n# ESTO ES CR√çTICO: Estimar la desviaci√≥n est√°ndar del proceso (sigma) a partir de R_barra\n# Usamos d2(n) para convertir el rango promedio en una estimaci√≥n de sigma\nsd_estimado_proceso <- R_barra / SixSigma::ss.cc.getd2(n)\n\n# Verifica si tus 'R' (datos$rango despu√©s de la eliminaci√≥n) tienen variabilidad.\n#print(paste(\"R_revisado despu√©s de la eliminaci√≥n:\", paste(R, collapse = \", \")))\n#print(paste(\"Media de R_revisado:\", R_barra))\n#print(paste(\"Desviaci√≥n est√°ndar estimada del proceso (sd_estimado_proceso):\", sd_estimado_proceso))\n\n\n# Realizar el an√°lisis de capacidad del proceso\n# Pasamos la desviaci√≥n est√°ndar estimada al objeto qcc\n# NOTA: qcc(data, type = \"xbar\", ...) espera 'data' sean los *datos crudos* para calcular medias y std.dev.\n# O si le pasas las medias de los subgrupos (como est√°s haciendo con X_bar),\n# DEBES proporcionar una estimaci√≥n de la desviaci√≥n est√°ndar del proceso ('std.dev')\n# o el rango promedio ('R.bar') si quieres que la estime de ah√≠.\n\nxbar_chart_obj <- qcc(X_bar, type = \"xbar\", sizes = n, plot = FALSE,\n                      std.dev = sd_estimado_proceso)\ncapability <- process.capability(xbar_chart_obj, spec.limits = spec.limits , print = FALSE)\n\n# Mostrar los √≠ndices de capacidad del proceso\n#print(capability)\n#summary(capability)\n#plot(capability) # Para ver la gr√°fica de capacidad corregida\n\n# Calcular la porci√≥n ca√≠da (esto deber√≠a ser consistente con 'capability$exp' ahora)\n# mean_data es la media del proceso\nmean_data <- mean(X_bar) # Usar la media de las X_bar revisadas\n\nlower_limit <- spec.limits[1]\nupper_limit <- spec.limits[2]\n\n# Proporci√≥n de unidades por debajo del l√≠mite inferior\nportion_below <- pnorm(lower_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Proporci√≥n de unidades por encima del l√≠mite superior\nportion_above <- 1 - pnorm(upper_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Porci√≥n ca√≠da total\nportion_fallen <- portion_below + portion_above\n\nportion_fallen <- sum(capability$exp)\n\n# Mostrar la porci√≥n ca√≠da\ncat(\"Porci√≥n ca√≠da:\", formato(portion_fallen), \"\\n\")\n```\nEl an√°lisis de capacidad del proceso para la dimensi√≥n de la parte revela que, aunque hay un margen, el desempe√±o no es completamente √≥ptimo.\n\nEl **√≠ndice de capacidad potencial del proceso ($C_p$) de 0.999** indica una capacidad potencial **marginal**. Esto sugiere que la variabilidad intr√≠nseca del proceso es casi igual a la amplitud de las especificaciones. Seg√∫n Montgomery, valores de $C_p$ entre 0.67 y 1.0 son **no adecuados para el trabajo**, se√±alando que el proceso requiere un an√°lisis profundo y modificaciones para alcanzar una calidad satisfactoria, a pesar de estar muy cerca de 1.0.\n\nEl **√≠ndice de capacidad real del proceso ($C_{pk}$) de 0.992** es la **preocupaci√≥n principal**. Al ser el menor de los $C_{pL}$ y $C_{pU}$ (siendo $C_{pL}$ el que lo determina), revela que el proceso **no est√° perfectamente centrado** dentro de los l√≠mites de especificaci√≥n, mostrando una ligera tendencia hacia el l√≠mite inferior. Este valor por debajo de 1.0 confirma que el proceso **no es capaz** de cumplir consistentemente con los requisitos, ya que existe una probabilidad real de producir piezas fuera de especificaci√≥n.\n\nEl **√≠ndice de capacidad de Taguchi ($C_{pm}$) de 0.999**, siendo muy cercano al $C_p$, sugiere que, aunque hay una variabilidad inherente que \"casi\" cabe en las especificaciones, la **desviaci√≥n respecto al valor objetivo (Target)** es m√≠nima. Esto refuerza la necesidad de mejorar la uniformidad y precisi√≥n, principalmente enfoc√°ndose en reducir la variabilidad para aumentar la holgura del proceso dentro de las especificaciones.\n\nLa **porci√≥n ca√≠da esperada (suma de Exp<LSL 0.15% y Exp>USL 0.13%) es de 0.28%**. Esto significa que aproximadamente el **0.28%** de las partes producidas se espera que est√©n fuera de los l√≠mites de especificaci√≥n. Aunque el porcentaje observado (`Obs<LSL 0%`, `Obs>USL 0%`) fue cero en las 22 muestras, la expectativa de casi un 0.3% de defectos subraya la importancia de implementar medidas correctivas para reducir esta proporci√≥n y mejorar la precisi√≥n general del proceso de manufactura.\n:::\n::::\n\n## Diagrama de control para la Media($\\bar{X}$) y la Desviaci√≥n Est√°ndar($S$)\nPara el caso de la media y la desviaci√≥n est√°ndar, se utilizan los diagramas de control $\\bar{X}$ y $S$, respectivamente. Estos diagramas son √∫tiles para monitorear la estabilidad del proceso en t√©rminos de su media y variabilidad. A continuaci√≥n, se muestra un ejemplo de c√≥mo construir estos diagramas a traves de un ejemplo pr√°ctico.\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dcxs .Example}\n### Aplicaci√≥n del diagrama de control para la Media($\\bar{X}$) y la Desviaci√≥n Est√°ndar($S$) {#sec-ejemplo-diagrama-xs}\n\n<br/>Se van a establecer gr√°ficas de control para la dureza Brinell de acero endurecido para herramientas, en kilogramos por mil√≠metro cuadrado. A continuaci√≥n se muestran los datos para tama√±os de subgrupo igual a 8. Determine la l√≠nea central y los l√≠mites de control tentativos para las gr√°ficas $\\bar{x}$ y $s$. Suponga que los puntos fuera de control tienen causas asignables, y calcule los l√≠mites y l√≠nea central revisados. Este ejemplo fue tomado de @besterfield1995control.\n\n```{r}\n#| label: tbl-datos-dureza_Brinell\n#| tbl-cap:  \"Mediciones para la dureza Brinell de acero endurecido para herramientas, en kilogramos por mil√≠metro cuadrado\"\n# Crear el dataframe en R\nnumero_de_subgrupo <- 1:25\nX_bar <- c(540, 534, 545, 561, 576, 523, 571, 547, 584, 552, 541, 545, 546, 551, 522, 579, 549, 508, 569, 574, 563, 561, 548, 556, 553)\nS <- c(26, 23, 24, 27, 25, 50, 29, 29, 23, 24, 28, 25, 26, 24, 29, 26, 28, 23, 22, 28, 33, 23, 25, 27, 23)\n\ndf_dureza <- data.frame(NUMERO_DE_SUBGRUPO = numero_de_subgrupo, X_bar = X_bar, S = S)\n\n# Prepare the data for reactable, adapting from 'pistones' structure\ndureza <- df_dureza |>\n  dplyr::mutate(\n    # 'muestra' corresponds to 'numero_de_subgrupo'\n    muestra = numero_de_subgrupo\n  ) |>\n  dplyr::rename(\n    media = X_bar,        \n    desviacion = S        \n  ) |>\n  dplyr::select(\n    muestra,\n    media,\n    desviacion\n  ) |>\n  data.table::as.data.table()\n\n# Set reactable language options\noptions(\n  reactable.language = reactableLang(\n    searchPlaceholder = \"Buscar...\",\n    pageNext = \"Siguiente\",\n    pagePrevious = \"Anterior\",\n    noData = \"No se encontraron entradas\",\n    pageInfo = \"{rowStart} de {rowEnd} de {rows} filas\"\n  )\n)\n\n# Generate the reactable table\nreactable::reactable(\n  dureza,\n  columns = list(\n    muestra = colDef(header = \"Muestra\", align = \"right\"),\n    media = colDef(\n      header = \"\\\\( \\\\bar{x}_{i} \\\\)\", align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 3, locales = \"es-ES\" # Adjusted digits for your data\n      )\n    ),\n    desviacion = colDef(\n      header = \"\\\\( S_{i} \\\\)\", align = \"right\", # Changed 'r' to correct S_i notation\n      format = colFormat(\n        separators = TRUE, digits = 2, locales = \"es-ES\" # Adjusted digits for your data\n      )\n    )\n  ),\n  striped = TRUE,\n  bordered = TRUE,\n  highlight = TRUE,\n  filterable = TRUE,\n  # You can add a defaultColDef if you want to apply common styles to all columns\n  defaultColDef = colDef(align = \"center\")\n)\n```\nUna vez observados los datos, Se proceder√° ahora a calcular los limites para ambos diagramas de control, para lo cual se usara igualmente el paquete `SixSigma` que contiene las constantes necesarias para calcular los limites de control, recordando que es un estudio inicial por lo que no se tienen ni los par√°metros ni estimaciones de los mismos. \n\nSe empezara calculando los limites del diagrama inicial $S$. Los cuales vienen dados por:\n$$\n\\begin{align*}\nLCS  & =  B_{4}\\,\\bar{S} \\\\\nLC  & =  \\bar{S}\\\\\nLCI  & = B_{3}\\,\\bar{S}\n\\end{align*}\n$$ {#eq-ls}\n\nPor lo que son necesarios los valores de $B_{3}$ y $B_{4}$, pueden ubicarse en sus respectivas tablas, o ser calculados en R mediante el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: B3-B4\n# Define the sample size (n) as specified in the Brinell problem\nn <- 8\n\n# Calculate control chart constants B_3 and B_4 for the S-chart\n# These constants depend on the sample size 'n' and SixSigma::ss.cc.getc4(n)\nB_3 <- ifelse(\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n) < 0, 0,\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\n)\nB_4 <- 1 + 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\npaste(\"B_3=\",B_3,\"   B_4=\",formato(B_4))\n```\n\nLos limites se calculan de la siguiente forma:\n\n```{r}\n#| label: lci-Sbarra\n# Calculate the overall average of the subgroup standard deviations (S-bar)\nS_barra <- mean(dureza$desviacion)\n\n# Calculate the control limits for the S-chart\nlci_S <- B_3 * S_barra # Lower Control Limit for S-chart\nlc_S <- S_barra        # Center Line for S-chart\nlcs_S <- B_4 * S_barra # Upper Control Limit for S-chart\n\n# Print the calculated control limits\npaste0(\"LCI_S = \", formato(lci_S), \"    LC_S = \", formato(lc_S), \"    LCS_S = \", formato(lcs_S))\n```\n\nManualmente, el calculo es el siguiente:\n\n$$\n\\begin{align*}\nLCS  & =  B_{4}\\,\\bar{S} = `r formato(B_4)`*`r formato(S_barra)`= `r formato(lcs_S)` \\\\\nLC  & =  \\bar{S}  = `r formato(lc_S)` \\\\\nLCI  & = B_{3}\\,\\bar{S} = `r formato(B_3)`*`r formato(S_barra)`= `r formato(lci_S)`\n\\end{align*}\n$$ \n\nLos limites para el diagrama de control $\\bar{x}$ se calculan de la siguiente forma:\n$$\n\\begin{align*}\nLCI & = \\bar{\\bar{x}} - A_{3}\\,\\bar{S}  \\\\\nLC & = \\bar{\\bar{x}}  \\\\\nLCS & = \\bar{\\bar{x}} + A_{3}\\,\\bar{S} \n\\end{align*}\n$${#eq-lix}\n\nMediante el siguiente bloque de c√≥digo se obtienen los limites: \n\n```{r}\n#| label: lci-xbarra2\nmedia_est <- mean(dureza$media)\nA_3 <- 3 / (sqrt(n) * SixSigma::ss.cc.getc4(n))\nlci_X <- media_est - A_3 * S_barra\nlc_X <-  media_est\nlcs_X <- media_est + A_3 * S_barra\npaste0(\"LCI = \", formato(lci_X), \"    LC = \", formato(lc_X), \"    LCS = \", formato(lcs_X))\n```\n\nManualmente, se obtienen mediante el siguiente calculo:\n\n$$\n\\begin{align*}\nLCI & = \\bar{\\bar{x}} - A_{3}\\,\\bar{S} = `r formato(media_est)`-`r formato(A_3)`*`r formato(S_barra)`= `r formato(lci_X)`\\\\\nLC & = \\bar{\\bar{x}} = `r formato(lc_X)` \\\\\nLCS & = \\bar{\\bar{x}} + A_{3}\\,\\bar{S} = `r formato(media_est)`+`r formato(A_3)`*`r formato(S_barra)`= `r formato(lcs_X)`\n\\end{align*}\n$$\nUna vez ya calculados los limites. A continuaci√≥n se muestran cada uno de estos diagramas:\n\n```{r}\n#| label: fig-Sinicial-highcharter\n#| fig-cap: \"Diagrama $S$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza,\n    hcaes(x = muestra, low = lc_S, high = lcs_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, \n    hcaes(x = muestra, low = lci_S, high = lc_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2,\n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza,\n    type = \"line\", hcaes(x = muestra, y = lcs_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lc_S), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lci_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = desviacion),\n    marker = list(radius = 3, fillColor = \"blue\"), # A√±adido fillColor para consistencia\n    useHTML = TRUE, name = \"<b><i>S<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Desviaci√≥n est√°ndar (S<sub>i</sub>)</i></b><br>\")\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar en la @fig-Sinicial-highcharter se observa que el punto 6 esta fuera de los limites de control, se concluye que el proceso no esta bajo control estadistico en varianza. Por lo que suponiendo causas asignables se eliminara del diagrama para recalcular los limites y observar nuevamente el comportamiento del proceso.\n\n```{r}\n#| label: fig-xbarra2-inicial-highcharter\n#| fig-cap: \"Diagrama $\\\\bar{x}$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nSe puede observar en la @fig-xbarra2-inicial-highcharter que se tienen dos puntos fuera de los limites de control, siendo los puntos 8 y 18. Ahora bien, el punto 15 se encuentra muy cercano teniendo una diferencia con este de 0,46, lo cual es menor a unidad. Basado en uno de los criterios de General Electric, el cual establece que un punto que se encuentre muy cercano a uno de los limites debera considerarse como una advertencia de que el proceso no esta funcionando como deberia. Por lo que el proceso no se encuentra bajo control estadistico en su media, suponiendo causas asignables se procedera a eliminar los tres puntos de proceso, recalcular los limites y graficar nuevamente el diagrama.\n\nLos nuevos limites para el diagrama $S$, se calculan en el siguiente bloque de c√≥digo: \n```{r}\n#| label: lci-s-def\ndureza <- dureza[-c(6,8,15,18)]\n# Calculate control chart constants B_3 and B_4 for the S-chart\n# These constants depend on the sample size 'n' and SixSigma::ss.cc.getc4(n)\nB_3 <- ifelse(\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n) < 0, 0,\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\n)\nB_4 <- 1 + 3 * sqrt(1 - SixSigma::ss.cc.getc4(n)^2) / SixSigma::ss.cc.getc4(n)\n\n# Calculate the overall average of the subgroup standard deviations (S-bar)\nS_barra <- mean(dureza$desviacion)\n\n# Calculate the control limits for the S-chart\nlci_S <- B_3 * S_barra # Lower Control Limit for S-chart\nlc_S <- S_barra        # Center Line for S-chart\nlcs_S <- B_4 * S_barra # Upper Control Limit for S-chart\n\n# Define the 'formato' function as it was used in your original snippet\n# (Assuming it formats numbers with commas as decimal separators and two digits)\nformato <- function(x, digits = 4) {\n  formatC(x, format = \"f\", digits = digits, big.mark = \".\", decimal.mark = \",\")\n}\n\n# Print the calculated control limits\npaste0(\"LCI_S = \", formato(lci_S), \"    LC_S = \", formato(lc_S), \"    LCS_S = \", formato(lcs_S))\n\n```\n\nPor otro lado, los nuevos limites para el diagrama $\\bar{X}$, se calculan en el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-xbarra2-def\nmedia_est <- mean(dureza$media)\nA_3 <- 3 / (sqrt(n) * SixSigma::ss.cc.getc4(n))\nlci_X <- media_est - A_3 * S_barra\nlc_X <-  media_est\nlcs_X <- media_est + A_3 * S_barra\npaste0(\"LCI = \", formato(lci_X), \"    LC = \", formato(lc_X), \"    LCS = \", formato(lcs_X))\n```\n\nA continuaci√≥n se muestran los diagramas de control:\n\n```{r}\n#| label: fig-Sinicial-highcharter-def\n#| fig-cap: \"Diagrama $S$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza,\n    hcaes(x = muestra, low = lc_S, high = lcs_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, \n    hcaes(x = muestra, low = lci_S, high = lc_S),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2,\n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza,\n    type = \"line\", hcaes(x = muestra, y = lcs_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lc_S), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, \n    type = \"line\", hcaes(x = muestra, y = lci_S), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\",\n    hcaes(x = muestra, y = desviacion),\n    marker = list(radius = 3, fillColor = \"blue\"), # A√±adido fillColor para consistencia\n    useHTML = TRUE, name = \"<b><i>S<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Desviaci√≥n est√°ndar (S<sub>i</sub>)</i></b><br>\")\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar en la @fig-Sinicial-highcharter-def ninguno de los puntos se encuentra fuera de los limites de control.\n\n```{r}\n#| label: fig-xbarra2-inicial-highcharter-def\n#| fig-cap: \"Diagrama $\\\\bar{x}$ para la dureza Brinell del acero (kg/mm¬≤) en la fase I con el paquete `highcharter`\"\nhighchart() |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lc_X, high = lcs_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    hcaes(x = muestra, low = lci_X, high = lc_X),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\",\n    color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lcs_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lc_X), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Usar datos auxiliares para los l√≠mites\n    type = \"line\", hcaes(x = muestra, y = lci_X), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = dureza, # Puntos de datos reales\n    type = \"line\", color = \"black\", hcaes(x = muestra, y = media),\n    marker = list(radius = 3, fillColor = \"blue\"),\n    useHTML = TRUE,\n    name = \"<b><i>Media</i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Muestra (n<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Media</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nIgualmente, como se puede observar ninguno de los puntos se encuentra fuera de los limites de control. Por lo que, dado que para ambos diagramas de control (@fig-Sinicial-highcharter-def y @fig-xbarra2-inicial-highcharter-def) no se encuentran ahora puntos fuera de control, se puede decir entonces que la dureza Brinell de acero endurecido para herramientas, en kilogramos por mil√≠metro cuadrado es estable tanto en media como en varianza.\n\n### Capacidad del Proceso\nPara determinar la capacidad del proceso estabilizado, se informa que la especificaci√≥n superior (LSE) para la dureza Brinell es de 600 kg/mm¬≤ y la especificaci√≥n inferior (LIE) es de 500 kg/mm¬≤. Con estos datos y las propiedades del proceso que has determinado (media del proceso revisada y desviaci√≥n est√°ndar estimada a partir del rango promedio revisado), calcula los √≠ndices de capacidad del proceso ($C_p$ y  $C_{pk}$) y eval√∫a qu√© tan bien est√° operando el proceso en relaci√≥n con las especificaciones.\n\nPara empezar, una vez determinado que el proceso se encuentra bajo control estadistico , se procede a calcular los indices de capacidad del proceso, por este motivo se supondr√° que los datos siguen una distribuci√≥n normal. \n\nLos limites de tolerancia natural fueron los establecidos anteriormente, siendo estos $`r formato(lci_X)`$ y $`r formato(lcs_X)`$.\n\n```{r}\n#| label: fig-xs-cp\n#| fig-cap: \"Capacidad del proceso\"\n\nX_bar <- dureza$media\nS <- dureza$desviacion\n# Establecer los l√≠mites de especificaci√≥n\nspec.limits <- c(500, 600)\n\n# Calcular la media del rango revisada\nS_barra <- mean(S)\n\n# ESTO ES CR√çTICO: Estimar la desviaci√≥n est√°ndar del proceso (sigma) a partir de R_barra\n# Usamos d2(n) para convertir el rango promedio en una estimaci√≥n de sigma\nsd_estimado_proceso <- S_barra / SixSigma::ss.cc.getd2(n)\n\nxbar_chart_obj <- qcc(X_bar, type = \"xbar\", sizes = n, plot = FALSE,\n                      std.dev = sd_estimado_proceso)\ncapability <- process.capability(xbar_chart_obj, spec.limits = spec.limits , print = FALSE)\n\n# Calcular la porci√≥n ca√≠da (esto deber√≠a ser consistente con 'capability$exp' ahora)\n# mean_data es la media del proceso\nmean_data <- mean(X_bar) # Usar la media de las X_bar revisadas\n\nlower_limit <- spec.limits[1]\nupper_limit <- spec.limits[2]\n\n# Proporci√≥n de unidades por debajo del l√≠mite inferior\nportion_below <- pnorm(lower_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Proporci√≥n de unidades por encima del l√≠mite superior\nportion_above <- 1 - pnorm(upper_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Porci√≥n ca√≠da total\nportion_fallen <- portion_below + portion_above\n\nportion_fallen <- sum(capability$exp)\n\n# Mostrar la porci√≥n ca√≠da\ncat(\"Porci√≥n ca√≠da:\", formato(portion_fallen), \"\\n\")\n```\n\nEl an√°lisis de capacidad del proceso para la **dureza Brinell de acero endurecido para herramientas** revela que el desempe√±o es **altamente capaz y robusto**. \n\nEl **√≠ndice de capacidad potencial del proceso ($C_p$) de 1.85** indica una **excelente capacidad potencial**. Esto sugiere que la variabilidad intr√≠nseca del proceso es significativamente menor que la amplitud de las especificaciones. Un $C_p$ mayor a 1.33 es generalmente considerado **altamente adecuado** para el trabajo, lo que significa que el proceso puede cumplir consistentemente con los l√≠mites de dureza Brinell establecidos.\n\nEl **√≠ndice de capacidad real del proceso ($C_{pk}$) de 1.59** confirma la **gran capacidad del proceso**. Este valor, determinado por el $C_{pU}$ (1.59 vs $C_{pL}$ 2.11), revela que el proceso est√° **bien centrado** dentro de los l√≠mites de especificaci√≥n, aunque con una ligera tendencia hacia el l√≠mite superior. Un $C_{pk}$ superior a 1.33 es una se√±al de un proceso **altamente capaz y robusto**, con un riesgo muy bajo de producir mediciones de dureza fuera de las especificaciones.\n\nEl **√≠ndice de capacidad de Taguchi ($C_{pm}$) de 1.46** corrobora la **solidez del proceso** al considerar no solo la variabilidad y la centraci√≥n, sino tambi√©n la desviaci√≥n respecto al valor objetivo (Target = 550 kg/mm¬≤). Este valor alto sugiere que la salida del proceso (media observada de 557.0476 kg/mm¬≤) est√° razonablemente cerca del objetivo, y la variabilidad es baja, lo que garantiza una alta calidad y consistencia.\n\nLa **porci√≥n ca√≠da esperada (Exp<LSL 0% y Exp>USL 0%) es de 0%** en ambos lados de las especificaciones. Esto significa que se espera que **ninguna de las mediciones de dureza Brinell** est√© fuera de los l√≠mites de especificaci√≥n. La **porci√≥n observada fue tambi√©n del 0%** (`Obs<LSL 0%`, `Obs>USL 0%`) en las 21 muestras, lo que refuerza la conclusi√≥n de que el proceso es **extremadamente capaz y estable**, produciendo constantemente resultados dentro de los requisitos de dureza.\n\n:::\n::::\n\n## Diagrama de control para la Media($\\bar{X}$) y la Desviaci√≥n Est√°ndar($S$) con tama√±o de muestra variable\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dxstmv .Example}\n## Aplicaci√≥n de los Diagramas $\\bar{x}$ y $S$ con tama√±o de muestra variable. {#sec-ejemplo-diagrama-xstmv}\n\n<br/>Una empresa de producci√≥n de alimentos se encuentra interesada en supervisar la concentraci√≥n de un conservante en los productos que ofrece, para ello toman entre 10 y 15 muestras de 20 lotes de producci√≥n distintos, midiendo la concentraci√≥n del conservante en su respectiva unidad.\n\nLa @tbl-datos-ejemplo-dxstmv muestra las medias y las desviaciones que present√≥ cada lote inspeccionado, junto con su la cantidad de muestras que se tom√≥ en el lote correspondiente. Este ejemplo fue tomado de @rendon2013control.\n\n```{r}\n#| label: tbl-datos-ejemplo-dxstmv\n#| tbl-cap: \"N√∫mero total de defectos en cada unidad de inspecci√≥n\"\n#| tbl-align: left\n#| tbl-colwidths: [20,40]\n\ndatos_xstmv <- tibble(\n  obs=c(1:20),\nmedias=c(1.76, 1.55, 1.79, 1.73, 1.74, 1.68, 1.84, 1.88, 1.83, 1.89, 1.76, 1.76, 1.85, 1.51, 2.08, 1.85, 1.69, 1.90, 1.84, 1.62\n  ),\ndes=c(0.486, 0.508, 0.396, 0.622, 0.484, 0.377, 0.532, 0.424, 0.527, 0.409, 0.443, 0.403, 0.578, 0.409, 0.424, 0.479, 0.438, 0.429, 0.484, 0.434\n  ),\ntamano=c(11L, 12L, 14L, 14L, 10L, 15L, 13L, 12L, 14L, 11L, 12L, 15L, 10L, 13L, 14L, 11L, 10L, 12L, 15L, 13L\n  )\n)\n\nknitr::kable(\n  datos_xstmv,\n  booktabs = TRUE,\n  format = \"html\",\n  col.names = c(\n    \"Lote\", \"Media\", \"Desviaci√≥n\", \"Tama√±o\"\n  ),\n  align = \"cc\",\n  escape = FALSE,\n) \n```\n\nPara la construcci√≥n del diagrama de control, se utilizar√° el criterio del tama√±o de muestra promedio, calculado de la siguiente forma:\n\n$$\n\\begin{equation}\n\\bar{n}= \\frac{\\sum_{i=1}^{m}n_i}{m}\n\\end{equation}\n$$ {#eq-tmp}\n\nEn R, el calculo se realiza de la siguiente forma:\n\n```{r}\n#| label: npro\nsumn <- sum(datos_xstmv$tamano)\nm <- 20\nnpro <- round(sumn/m,0)\npaste(npro)\n```\n\nLos limites de control para el diagrama $S$ se obtienen de la siguiente forma: \n$$\n\\begin{align*}\nLCI & = B_{3}\\left(\\bar{n} \\right)\\,\\bar{S} \\\\\nLC & = \\bar{S} \\\\\nLCS & = B_{4}\\left(\\bar{n} \\right)\\,\\bar{S} \n\\end{align*}\n$$ {#eq-lstmv}\n\nDel mismo, se calculan con R utilizando el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-Sbarratmv\n\nB_3 <- ifelse(\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(npro)^2) / SixSigma::ss.cc.getc4(npro) < 0, 0,\n  1 - 3 * sqrt(1 - SixSigma::ss.cc.getc4(npro)^2) / SixSigma::ss.cc.getc4(npro)\n)\nB_4 <- 1 + 3 * sqrt(1 - SixSigma::ss.cc.getc4(npro)^2) / SixSigma::ss.cc.getc4(npro)\n\nmedia_est <- mean(datos_xstmv$medias)\nS_barra <- mean(datos_xstmv$des)\nlci_S <- B_3 * S_barra\nlc_S <- S_barra\nlcs_S <- B_4 * S_barra\npaste0(\"LCI = \", formato(lci_S), \"    LC = \", formato(lc_S), \"    LCS = \", formato(lcs_S))\n\n```\n\nLos limites de control para $\\bar{x}$ vienen dados por la siguiente expresi√≥n:\n\n$$\n\\begin{align*}\nLCI & = \\bar{\\bar{x}} - A_{3}\\left(\\bar{n} \\right)\\,\\bar{S}  \\\\\nLC & = \\bar{\\bar{x}} \\\\\nLCS & = \\bar{\\bar{x}} + A_{3}\\left(\\bar{n} \\right)\\,\\bar{S}\n\\end{align*}\n$$ {#eq-lcxtmv}\n\nEn R, el calculo se realiza mediante el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-xbarra3\n\nA_3 <- 3 / (sqrt(npro) * SixSigma::ss.cc.getc4(npro))\nlci <- media_est - A_3 * S_barra\nlc <-  media_est\nlcs <- media_est + A_3 * S_barra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nLa representaci√≥n gr√°fica de este diagrama se observa en la @fig-dcxbarraStmv-qcc:\n\n```{r}\n#| label: fig-dcxbarraStmv-qcc\n#| fig-cap: \"Diagramas $\\\\bar{x}$ y $S$ para la cantidad de conservante por lote con el paquete `qcc`\"\n#| fig-subcap:\n#|   - \"Diagrama $S$ inicial\"\n#|   - \"Diagrama $\\\\bar{x}$ inicial\"\n#| layout-ncol: 2\n\n# Diagrama S en la fase 1\nS1 <- qcc(\n  datos_xstmv$des,sizes = npro,limits = c(lci_S, lcs_S),\n  type = \"S\", plot = FALSE\n)\nplot(\n  S1,\n  add.stats = FALSE, label.limits = c(\"LCI\", \"LCS\"),\n  title = \"\", xlab = \"Lote\", ylab = \"Desviaci√≥n est√°ndar\",\n  chart.all = TRUE\n)\n\n# Diagrama xbarra en la fase 1\nxbarra_xs2 <- qcc(\n  datos_xstmv$medias, sizes = npro,limits = c(lci, lcs),\n  type = \"xbar\",\n  plot = FALSE\n)\nplot(\n  xbarra_xs2,\n  add.stats = FALSE, label.limits = c(\"LCI\", \"LCS\"),\n  title = \"\", xlab = \"Lote\", ylab = \"Medias\",\n  chart.all = TRUE\n)\n\n```\n\n```{r}\n#| label: fig-dcxbarraStmv-highcharter\n#| fig-cap: \"Diagrama $S$ para la cantidad de conservante por lote con `highcharter`\"\n#| echo: false\n#| include: false\n\n# highchart() |>\n#   hc_add_series(\n#     data = datos_xstmv,\n#     hcaes(x = obs, low = lcs, high = lc),\n#     step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n#     type = \"arearange\", fillOpacity = 0.2, name = \"Rango Superior\", color = \"green\",\n#     showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n#   ) |>\n#   hc_add_series(\n#     data = datos_xstmv,\n#     hcaes(x = obs, low = lci, high = lc),\n#     step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n#     type = \"arearange\", fillOpacity = 0.2, name = \"Rango Inferior\", color = \"blue\",\n#     showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", hcaes(x = obs, y = lcs), useHTML = TRUE,\n#     color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n#     step = \"hv\", marker = list(enabled = FALSE),\n#     tooltip = list(valueDecimals = 4) # Ajusta los decimales seg√∫n la precisi√≥n de tus datos\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", hcaes(x = obs, y = lc), useHTML = TRUE,\n#     color = \"blue\", name = \"<b><i>LC</b></i>\",\n#     step = \"hv\", marker = list(enabled = FALSE),\n#     tooltip = list(valueDecimals = 4)\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", hcaes(x = obs, y = lci), useHTML = TRUE,\n#     color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n#     step = \"hv\", marker = list(enabled = FALSE),\n#     tooltip = list(valueDecimals = 4)\n#   ) |>\n#   hc_add_series(\n#     datos_xstmv,\n#     type = \"line\", color = \"black\",\n#     hcaes(x = obs, y = des), # 'des' es la columna de desviaci√≥n est√°ndar/rango\n#     marker = list(radius = 3),\n#     useHTML = TRUE, name = \"<b><i>S<sub>i</sub></i></b>\",\n#     dashStyle = \"Solid\", # O \"Dash\" si prefieres\n#     tooltip = list(valueDecimals = 4)\n#   ) |>\n#   hc_xAxis(\n#     title = list(\n#       useHTML = TRUE,\n#       text = \"<b><i>Lote</b></i><br>\"\n#     )\n#   ) |>\n#   hc_yAxis(\n#     title = list(\n#       useHTML = TRUE,\n#       text = \"<b><i>Desviaci√≥n est√°ndar (S<sub>i</sub>)</b></i><br>\"\n#     )\n#   ) |>\n#   hc_tooltip(crosshairs = TRUE, shared = TRUE) |>\n#   hc_plotOptions(series = list(animation = FALSE)) |>\n#   hc_title(text = \"Diagrama S inicial\") # T√≠tulo para el sub-gr√°fico\n```\n\n\nSe observa que tanto el diagrama de control de la **desviaci√≥n est√°ndar ($S$)** como el diagrama de control de la **media ($\\bar{X}$)**, como se muestra en la Figura @fig-dcxbarraStmv-qcc, tienen **todos sus puntos dentro de los l√≠mites de control**.\n\nEsto indica que la **variabilidad del proceso** est√° bajo control estad√≠stico, permitiendo utilizar la estimaci√≥n de $\\sigma$ (la desviaci√≥n est√°ndar del proceso) para el monitoreo futuro. De manera similar, el **centro del proceso** tambi√©n est√° bajo control estad√≠stico, operando bajo causas fortuitas. Por lo tanto, la estimaci√≥n de $\\mu$ (la media del proceso) puede emplearse para supervisar las futuras concentraciones de conservantes en los alimentos producidos.\n\nEn resumen, el proceso de concentraci√≥n de conservantes en los alimentos se encuentra en **estado de control estad√≠stico**, tanto en su variabilidad como en su promedio, lo que permite la utilizaci√≥n de las estimaciones actuales para su supervisi√≥n y mejora continua.\n\n### Capacidad del Proceso\n\nPara determinar la capacidad del proceso estabilizado, se informa que la especificaci√≥n superior (LSE) para la concentraci√≥n de conservante es de 2.0 y la especificaci√≥n inferior (LIE) es de 1.0. Con estos datos y las propiedades del proceso que has determinado (media del proceso revisada y desviaci√≥n est√°ndar estimada a partir del rango promedio revisado), calcula los √≠ndices de capacidad del proceso ($C_p$ y  $C_{pk}$) y eval√∫a qu√© tan bien est√° operando el proceso en relaci√≥n con las especificaciones.\n\nLos l√≠mites de tolerancia natural fueron los establecidos anteriormente, siendo estos $`r formato(lci)`$ y $`r formato(lcs)`$. \n\n```{r}\n#| label: fig-xstmv-cp\n#| fig-cap: \"Capacidad del proceso\"\n\nX_bar <- datos_xstmv$medias\nS <- datos_xstmv$des\n# Establecer los l√≠mites de especificaci√≥n\nspec.limits <- c(1, 2)\n\n# Calcular la media del rango revisada\nS_barra <- mean(S)\n\n# ESTO ES CR√çTICO: Estimar la desviaci√≥n est√°ndar del proceso (sigma) a partir de R_barra\n# Usamos d2(n) para convertir el rango promedio en una estimaci√≥n de sigma\nsd_estimado_proceso <- S_barra / SixSigma::ss.cc.getd2(npro)\n\nxbar_chart_obj <- qcc(X_bar, type = \"xbar\", sizes = npro, plot = FALSE,\n                      std.dev = sd_estimado_proceso)\ncapability <- process.capability(xbar_chart_obj, spec.limits = spec.limits , print = FALSE)\n\n# Calcular la porci√≥n ca√≠da (esto deber√≠a ser consistente con 'capability$exp' ahora)\n# mean_data es la media del proceso\nmean_data <- mean(X_bar) # Usar la media de las X_bar revisadas\n\nlower_limit <- spec.limits[1]\nupper_limit <- spec.limits[2]\n\n# Proporci√≥n de unidades por debajo del l√≠mite inferior\nportion_below <- pnorm(lower_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Proporci√≥n de unidades por encima del l√≠mite superior\nportion_above <- 1 - pnorm(upper_limit, mean = mean_data, sd = sd_estimado_proceso)\n\n# Porci√≥n ca√≠da total\nportion_fallen <- portion_below + portion_above\n\nportion_fallen <- sum(capability$exp)\n\n# Mostrar la porci√≥n ca√≠da\ncat(\"Porci√≥n ca√≠da:\", formato(portion_fallen), \"\\n\")\n```\n\nEl an√°lisis de capacidad del proceso para la **concentraci√≥n de conservantes** en los productos alimenticios revela un desempe√±o con **oportunidades significativas de mejora**. \n\nEl **√≠ndice de capacidad potencial del proceso ($C_p$) de 1.2** indica una capacidad potencial **aceptable, pero no √≥ptima**. Esto sugiere que la variabilidad intr√≠nseca del proceso, si estuviera perfectamente centrado, apenas cabe dentro de la amplitud de las especificaciones. Aunque un $C_p$ de 1.2 est√° por encima del umbral de 1.0 (que Montgomery considera \"no adecuado\"), a√∫n **no alcanza los niveles deseables de 1.33 o 1.67** para procesos de clase mundial, lo que significa que la variabilidad es a√∫n considerable en relaci√≥n con la tolerancia.\n\nEl **√≠ndice de capacidad real del proceso ($C_{pk}$) de 0.533** es la **principal preocupaci√≥n** en este an√°lisis. Al ser significativamente menor que 1.0, y en este caso determinado por $C_{pU}$ (0.533 vs $C_{pL}$ 1.86), revela que el proceso est√° **mal centrado** y muestra una **fuerte tendencia hacia el L√≠mite Superior de Especificaci√≥n (USL)**. Este valor, muy por debajo de 1.0, confirma que el proceso **no es capaz** de cumplir consistentemente con los requisitos de concentraci√≥n, ya que una parte sustancial de la distribuci√≥n se extiende m√°s all√° del l√≠mite superior.\n\nEl **√≠ndice de capacidad de Taguchi ($C_{pm}$) de 0.537** corrobora la **deficiencia del proceso**. Este valor, cercano al $C_{pk}$, refleja que la desviaci√≥n del proceso no solo es notable en relaci√≥n con las especificaciones, sino que tambi√©n est√° **desalineado con el valor objetivo (Target = 1.5)**. La media del proceso (1.7775) se ha desplazado considerablemente del objetivo, lo que penaliza fuertemente este √≠ndice y refuerza la necesidad urgente de reajustar la centraci√≥n del proceso.\n\nLa **porci√≥n ca√≠da esperada (Exp>USL 5.5%) es de 5.5%** por encima del l√≠mite superior. Esto significa que aproximadamente el **5.5%** de los lotes de producci√≥n se espera que tengan una concentraci√≥n de conservante por encima del l√≠mite permitido. Aunque la **porci√≥n observada fue del 0%** por debajo del LSL y **5%** por encima del USL en las 20 muestras (`Obs<LSL 0%`, `Obs>USL 5%`), la alta expectativa de defectos subraya la importancia cr√≠tica de implementar medidas correctivas inmediatas para **reducir la concentraci√≥n promedio y su variabilidad**, asegurando as√≠ que los productos cumplan con las normativas de conservantes.\n:::\n::::\n\n## Diagrama de Control Para Observaciones Individuales\n\n:::: {.callout-tip icon=\"false\" appearance=\"simple\"}\n::: {#exm-dcmr .Example}\n### Aplicaci√≥n del diagrama de control $MR$ {#sec-ejemplo-diagrama-mr}\n\n<br/>En el departamento de sistemas se lleva un registro del tiempo de respuesta a solicitudes de servicio de clientes internos. Los √∫ltimos datos en horas y en el orden de ocurrencia se muestran en la @tbl-datos-tiempo_respuesta_solicitudes. Obtenga los l√≠mites de control para una carta de control de individuales e interpr√©telos. Este ejemplo fue tomado de @gutierrez2009control.\n\n```{r}\n#| label: tbl-datos-tiempo_respuesta_solicitudes\n#| tbl-cap:  \"Registros del tiempo de respuesta a solicitudes de servicio de clientes internos\"\nresponse_times <- c(\n  39, 35, 49, 92, 41, 57, 38, 37, 33, 33, 44, 34, 119, 37,\n  34, 32, 34, 23, 96, 43, 36, 32, 35, 42, 42, 34, 86, 27,\n  42, 117, 33, 39, 43, 37, 78, 42, 37, 37, 33, 96, 26, 37,\n  29, 32, 38, 98, 39, 43, 126, 87, 46, 31, 109, 37, 40, 37,\n  28, 52, 122, 40, 29, 33, 35, 71, 62\n)\n\n# Create a dataframe for individual observations\n# For individual charts, each observation is a \"subgroup\" of size 1.\n# We'll create an index for each observation.\nindividual_times <- data.table::data.table(\n  check.names = FALSE,\n  Observacion = 1:length(response_times),\n  Tiempo_Respuesta_Horas = response_times\n) |>\n  dplyr::mutate(\n    MR = c(NA, abs(diff(Tiempo_Respuesta_Horas)))\n  ) |>\n  data.table::data.table()\n\noptions(\n  reactable.language = reactableLang(\n    searchPlaceholder = \"Buscar\",\n    pageNext = \"Siguiente\",\n    pagePrevious = \"Anterior\",\n    noData = \"Ninguna fila encontrada\",\n    pageInfo = \"{rowStart} de {rowEnd} de {rows} filas\"\n  )\n)\n\nreactable::reactable(\n  individual_times,\n  # defaultColDef = colDef(\n  #   headerStyle = list(background = \"#f7f7f8\")\n  # ),\n  columns = list(\n    Observacion = colDef(header = \"N√∫mero de Observacion\", align = \"right\"),\n    Tiempo_Respuesta_Horas = colDef(\n      header = \"Tiempo de respuesta \\\\(\\\\left( x_{i} \\\\right) \\\\)\", \n      align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 2, locales = \"es-ES\"\n      )\n    ),\n    MR = colDef(\n      header = \"Rango M√≥vil \\\\(\\\\left({MR}_{i}\\\\right)\\\\)\", \n      align = \"right\",\n      format = colFormat(\n        separators = TRUE, digits = 2, locales = \"es-ES\"\n      )\n    )\n  ),\n  striped = TRUE,\n  bordered = TRUE,\n  highlight = TRUE,\n  filterable = TRUE,\n  minRows = 10\n)\n```\n\nPara estimar los parametros del diagrama es necesario calcular la media de la variable de interes, en este caso el tiempo de respuesta, y la media de los rangos moviles, este calculo es bastante sencillo, teniendo entonces $\\bar{x}$= `r formato(mean(individual_times$Tiempo_Respuesta_Horas))` y $\\overline{MR}$= `r formato(mean(individual_times$MR,na.rm = TRUE))` \n\nLos limites para el diagrama $x$ inicial se calculan de la siguiente forma:\n\n$$\n\\begin{align*}\nLCS  & =  \\bar{x} + 2,6596 \\, \\overline{MR} \\\\\nLC  & =  \\bar{x} \\\\\nLCI  & = \\bar{x} - 2,6596\\, \\overline{MR} \n\\end{align*}\n$$ {#eq-lsxmr}\n\nMediante R, se calculan utilizando el siguiente bloque de c√≥digo:\n\n```{r}\n#| label: lci-x\n\nxbarra <- mean(individual_times$Tiempo_Respuesta_Horas)\nMRbarra <- mean(individual_times$MR, na.rm = TRUE)\ndesviacion <- MRbarra / 1.128\n\nlci <- xbarra - 2.6596 * MRbarra\nlc <-  xbarra\nlcs <- xbarra + 2.6596 * MRbarra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nManualmente, estos limites se calculan de la siguiente forma:\n\n$$\n\\begin{align*}\nLCS  & =  \\bar{x} + 2,6596 \\, \\overline{MR} = `r formato(xbarra)`+2,6596*`r formato(MRbarra)`= `r formato(lcs)` \\\\\nLC  & =  \\bar{x} = `r formato(lc)` \\\\ \nLCI  & = \\bar{x} - 2,6596\\, \\overline{MR} = `r formato(xbarra)`-2,6596*`r formato(MRbarra)`= `r formato(lci)`\n\\end{align*}\n$$\nLos limites para el diagrama inicial $MR$ se obtienen de la siguiente forma:\n$$\n\\begin{align*}\nLCS  & = 3,2677 \\, \\overline{MR}\\\\\nLC  & = \\overline{MR} \\\\\nLCI  & = 0\n\\end{align*}.\n$$ {#eq-lsxmr1}\n\nUtilizando Rstudio, se calculan utilizando el siguiente bloque de c√≥digo: \n\n```{r}\n#| label: lci-MR\n\nlci_MR <- 0\nlc_MR <- MRbarra\nlcs_MR <- 3.2677 * MRbarra\npaste0(\n  \"LCI = \", formato(lci_MR), \"    LC = \", formato(lc_MR), \"    LCS = \", formato(lcs_MR)\n)\n```\n\nManualmente, se obtienen mediante el siguiente calculo:\n\n$$\n\\begin{align*}\nLCS  & = 3,2677 \\, \\overline{MR}= 3,2677*`r formato(MRbarra)`= `r formato(lcs_MR)`\\\\\nLC  & = \\overline{MR} = `r formato(lc_MR)` \\\\ \nLCI  & = 0\n\\end{align*}.\n$$\nLa estimaci√≥n de la desviaci√≥n viene dada por la siguiente expresi√≥n:\n\n$$\n\\begin{equation}\n\\hat{\\sigma}=\\frac{\\overline{\\textit{MR}}}{1,1284} = \\frac{`r MRbarra`}{1,1284}=`r formato(desviacion)`\n\\end{equation}\n$$\n\nUna vez los limites de control, ya es posible graficar los diagramas de control. Los cuales se pueden observar a continuacion:\n\n```{r}\n#| label: fig-MRinicial-highcharter\n#| fig-cap: \"Diagrama $\\\\textit{MR}$ inicial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc_MR, high = lcs_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci_MR, high = lc_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc_MR), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\",\n    hcaes(x = Observacion, y = MR),\n    marker = list(radius = 3),useHTML = TRUE, \n    name = \"<b><i>MR<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de Observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango m√≥vil (MR<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nComo se puede observar en la @fig-MRinicial-highcharter, el diagrama de control $MR$ inicial muestra que **todos los puntos est√°n dentro de los l√≠mites de control**, lo que indica que el proceso est√° bajo control estad√≠stico. Esto significa que la variabilidad del proceso es consistente y no hay evidencia de causas especiales que afecten el rango m√≥vil entre observaciones consecutivas.\n\n```{r}\n#| label: fig-x-inicial-highcharter\n#| fig-cap: \"Diagrama $x$ incial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc, high = lcs),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci, high = lc),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\", \n    hcaes(x = Observacion, y = Tiempo_Respuesta_Horas),\n    marker = list(radius = 3),  useHTML = TRUE, \n    name = \"<b><i>x<sub>i</sub></i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Tiempo de respuesta de solicitudes  (x<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nEl diagrama de control $x$ inicial, como se muestra en la @fig-x-inicial-highcharter, indica que el punto numero 49 esta fuera de los limites de control. Esto sugiere que el proceso de respuesta a solicitudes de servicio no est√° bajo control estad√≠stico, y la media del tiempo de respuesta no es consistente a lo largo del tiempo.\n\nSe calculan nuevamente los limites para el diagrama $x$ y $MR$ eliminando el punto 49, que es el √∫nico punto fuera de los limites de control:\n\n```{r}\n#| label: lci-MR-pre-def\nindividual_times1 <- individual_times[-49]\nxbarra <- mean(individual_times1$Tiempo_Respuesta_Horas)\nMRbarra <- mean(individual_times1$MR, na.rm = TRUE)\ndesviacion <- MRbarra / 1.128\n\nlci <- xbarra - 2.6596 * MRbarra\nlc <-  xbarra\nlcs <- xbarra + 2.6596 * MRbarra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nLos nuevos limites para el diagrama $x$ son:\n\n```{r}\n#| label: lci-x-pre-def\nlci_MR <- 0\nlc_MR <- MRbarra\nlcs_MR <- 3.2677 * MRbarra\npaste0(\n  \"LCI = \", formato(lci_MR), \"    LC = \", formato(lc_MR), \"    LCS = \", formato(lcs_MR)\n)\n```\n\n```{r}\n#| label: fig-MRinicial-highcharter-pre-def\n#| fig-cap: \"Diagrama $\\\\textit{MR}$ inicial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lc_MR, high = lcs_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lci_MR, high = lc_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lcs_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", hcaes(x = Observacion, y = lc_MR), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lci_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", color = \"black\",\n    hcaes(x = Observacion, y = MR),\n    marker = list(radius = 3),useHTML = TRUE, \n    name = \"<b><i>MR<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de Observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango m√≥vil (MR<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\n\n```{r}\n#| label: fig-x-inicial-highcharter-pre-def\n#| fig-cap: \"Diagrama $x$ incial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lc, high = lcs),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    hcaes(x = Observacion, low = lci, high = lc),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lcs), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", hcaes(x = Observacion, y = lc), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1, \n    type = \"line\", hcaes(x = Observacion, y = lci), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times1,\n    type = \"line\", color = \"black\", \n    hcaes(x = Observacion, y = Tiempo_Respuesta_Horas),\n    marker = list(radius = 3),  useHTML = TRUE, \n    name = \"<b><i>x<sub>i</sub></i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Tiempo de respuesta de solicitudes  (x<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\nAl observar la @fig-x-inicial-highcharter-pre-def se tiene que el punto 59 esta fuera de control. A partir de este paso se requieren de una serie de iteraciones para poder obtener un diagrama de control $x$ y $MR$ que cumpla con los requisitos de control estad√≠stico. Se utilizo en la parte de analisis del statgraphics correspondiente para el analisis de este diagrama, que exluyera automaticamente segun hubieran puntos fuera de control. Este proceso iterativo determino que las mediciones excluidas son la 4,5,6,7,8,9,10,13,19,20, 27,28,30,31,32,35,40,41,46,49,50,53,58,59,64 y 65.\n\nSe calculan nuevamente los limites para el diagrama $x$ y $MR$ eliminando los puntos fuera de control, que son los puntos 4,5,6,7,8,9,10,13,19,20,27,28,30,31,32,35,40,41,46,49,50,53,58,59,64 y 65:\n\n```{r}\n#| label: lci-MR-def\nindividual_times <- individual_times[-c(4,5,6,7,8,9,10,13,19,20,27,28,30,31,32,35,40,41,46,49,50,53,58,59,64,65)]\n\nxbarra <- mean(individual_times$Tiempo_Respuesta_Horas)\nMRbarra <- mean(individual_times$MR, na.rm = TRUE)\ndesviacion <- MRbarra / 1.128\n\nlci <- xbarra - 2.6596 * MRbarra\nlc <-  xbarra\nlcs <- xbarra + 2.6596 * MRbarra\npaste0(\"LCI = \", formato(lci), \"    LC = \", formato(lc), \"    LCS = \", formato(lcs))\n```\n\nLos nuevos limites para el diagrama $x$ son:\n\n```{r}\n#| label: lci-x-def\nlci_MR <- 0\nlc_MR <- MRbarra\nlcs_MR <- 3.2677 * MRbarra\npaste0(\n  \"LCI = \", formato(lci_MR), \"    LC = \", formato(lc_MR), \"    LCS = \", formato(lcs_MR)\n)\n```\n\nSe grafican los diagramas de control $x$ y $MR$ con los nuevos limites de control:\n\n```{r}\n#| label: fig-MRinicial-highcharter-def\n#| fig-cap: \"Diagrama $\\\\textit{MR}$ inicial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc_MR, high = lcs_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci_MR, high = lc_MR),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, \n    name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc_MR), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci_MR), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\",\n    hcaes(x = Observacion, y = MR),\n    marker = list(radius = 3),useHTML = TRUE, \n    name = \"<b><i>MR<sub>i</sub></i></b>\",\n    dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de Observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Rango m√≥vil (MR<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\n\n\n```{r}\n#| label: fig-x-inicial-highcharter-def\n#| fig-cap: \"Diagrama $x$ incial para el tiempo de respuesta a solicitudes de servicio de clientes internos con el paquete `highcharter`\"\n\nhighchart() |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lc, high = lcs),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"green\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    hcaes(x = Observacion, low = lci, high = lc),\n    step = \"hv\", marker = list(enabled = FALSE, visible = FALSE),\n    type = \"arearange\", fillOpacity = 0.2, name = \"\", color = \"blue\",\n    showInLegend = FALSE, tooltip = list(pointFormat = \"{NULL}\")\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lcs), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCS</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", hcaes(x = Observacion, y = lc), useHTML = TRUE,\n    color = \"blue\", name = \"<b><i>LC</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times, \n    type = \"line\", hcaes(x = Observacion, y = lci), useHTML = TRUE,\n    color = \"red\", dashStyle = \"Dash\", name = \"<b><i>LCI</b></i>\",\n    step = \"hv\", marker = list(enabled = FALSE),\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_add_series(\n    data = individual_times,\n    type = \"line\", color = \"black\", \n    hcaes(x = Observacion, y = Tiempo_Respuesta_Horas),\n    marker = list(radius = 3),  useHTML = TRUE, \n    name = \"<b><i>x<sub>i</sub></i></b>\", dashStyle = \"Dash\",\n    tooltip = list(valueDecimals = 2)\n  ) |>\n  hc_xAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>N√∫mero de observacion</b><br>\"\n    )\n  ) |>\n  hc_yAxis(\n    title = list(\n      useHTML = TRUE,\n      text = \"<b><i>Tiempo de respuesta de solicitudes  (x<sub>i</sub>)</i></b><br>\"\n    )\n  ) |>\n  hc_tooltip(crosshairs = TRUE, shared = TRUE) |> \n  hc_plotOptions(series = list(animation = FALSE) )\n```\n\n### Capacidad del Proceso\n:::\n::::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"github","html-math-method":"mathjax","number-sections":true,"toc":true,"toc-depth":4,"css":["styles.css"],"output-file":"variables_indices_cap.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta p√°gina","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de c√≥digo","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Art√≠culo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar c√≥digo fuente","notebook-preview-back":"Volver al Art√≠culo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Ap√©ndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilizaci√≥n","section-title-copyright":"Derechos de autor","section-title-citation":"C√≥mo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliaci√≥n","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicaci√≥n","title-block-modified":"Fecha de modificaci√≥n","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precauci√≥n","code-summary":"C√≥digo","code-tools-menu-caption":"C√≥digo","code-tools-show-all-code":"Mostrar todo el c√≥digo","code-tools-hide-all-code":"Ocultar todo el c√≥digo","code-tools-view-source":"Ver el c√≥digo fuente","code-tools-source-code":"Ejecutar el c√≥digo","tools-share":"Compartir","tools-download":"Descargar","code-line":"L√≠nea","code-lines":"L√≠neas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta p√°gina","repo-action-links-source":"Ver el c√≥digo","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la b√∫squeda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar secci√≥n","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegaci√≥n de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposici√≥n","crossref-cnj-title":"Conjetura","crossref-def-title":"Definici√≥n","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Cap√≠tulo","crossref-apx-prefix":"Ap√©ndice","crossref-sec-prefix":"Secci√≥n","crossref-eq-prefix":"Ecuaci√≥n","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observaci√≥n","environment-solution-title":"Soluci√≥n","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"M√°s reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"T√≠tulo","listing-page-field-description":"Descripci√≥n","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificaci√≥n","listing-page-field-subtitle":"Subt√≠tulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categor√≠as","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es-ES","fig-responsive":true,"quarto-version":"1.6.42","bibliography":["references.bib"],"nocite":"@*\n","editor":"visual","author-title":"AUTOR","code-copy":true,"code-summary":"C√≥digo","code-block-bg":true,"code-block-border-left":"#31BAE9","code-block-border-left-size":"3px","callout-border-width":"1px","number-depth":4,"toc-location":"right","toc-title":"Contenido","html":{"toc-title":"Contenido"},"theme":["cosmo"],"title":"Diagramas de Control para Variables y An√°lisis de Indices de Capacidad de Procesos Aplicados con ${\\color{Blue} \\textbf{\\textsf{R}}}$"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"variables_indices_cap.pdf"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta p√°gina","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de c√≥digo","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Art√≠culo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar c√≥digo fuente","notebook-preview-back":"Volver al Art√≠culo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Ap√©ndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilizaci√≥n","section-title-copyright":"Derechos de autor","section-title-citation":"C√≥mo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliaci√≥n","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicaci√≥n","title-block-modified":"Fecha de modificaci√≥n","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precauci√≥n","code-summary":"C√≥digo","code-tools-menu-caption":"C√≥digo","code-tools-show-all-code":"Mostrar todo el c√≥digo","code-tools-hide-all-code":"Ocultar todo el c√≥digo","code-tools-view-source":"Ver el c√≥digo fuente","code-tools-source-code":"Ejecutar el c√≥digo","tools-share":"Compartir","tools-download":"Descargar","code-line":"L√≠nea","code-lines":"L√≠neas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta p√°gina","repo-action-links-source":"Ver el c√≥digo","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la b√∫squeda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar secci√≥n","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegaci√≥n de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposici√≥n","crossref-cnj-title":"Conjetura","crossref-def-title":"Definici√≥n","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Cap√≠tulo","crossref-apx-prefix":"Ap√©ndice","crossref-sec-prefix":"Secci√≥n","crossref-eq-prefix":"Ecuaci√≥n","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observaci√≥n","environment-solution-title":"Soluci√≥n","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"M√°s reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"T√≠tulo","listing-page-field-description":"Descripci√≥n","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificaci√≥n","listing-page-field-subtitle":"Subt√≠tulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categor√≠as","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"nocite":"@*\n","editor":"visual","lang":"es-ES","documentclass":"scrreprt","title":"Diagramas de Control para Variables y An√°lisis de Indices de Capacidad de Procesos Aplicados con ${\\color{Blue} \\textbf{\\textsf{R}}}$"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}